import{d as A,r,k as O,o as z,c as n,a as t,b as m,n as $,t as u,l as p,v as w,F as C,f as D,j as f,e as Q,p as S,q as R,i as o}from"./index-CNnF1iXF.js";import{a as g,_ as H}from"./_plugin-vue_export-helper-1WfN36Ns.js";import{s as J}from"./toast-BHygDFPs.js";const K={class:"editor"},W={class:"tabs"},X={key:0,class:"domains-list"},Y={class:"search-box"},Z={key:0,class:"loading"},ee={key:1,class:"empty"},te={key:2,class:"empty"},ae={key:3,class:"domain-grid"},le=["onClick"],se={class:"domain-header"},ne={class:"header-actions"},oe={class:"badge"},ie=["onClick"],ue={class:"domain-fields"},de={key:1},re={key:0,class:"editing-banner"},ve={class:"layout"},ce={class:"form-panel"},me={class:"form-group"},pe={class:"fields-section"},fe=["onUpdate:modelValue"],be=["onUpdate:modelValue"],_e=["value"],ye=["value","onInput"],ge=["onClick","disabled"],ke={class:"options"},he={class:"form-group inline"},we={"data-tooltip":"å¯ç”¨åå°†æ·»åŠ  DeletedAt å­—æ®µï¼Œåˆ é™¤æ—¶æ ‡è®°è€ŒéçœŸåˆ é™¤"},Ce={class:"form-group inline"},De={"data-tooltip":"è‡ªåŠ¨åœ¨ main.go ä¸­æ³¨å†Œæ­¤æ¨¡å—"},xe={class:"form-group inline"},Ve={"data-tooltip":"è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶"},Ue={key:0,class:"force-warning"},Fe={class:"advanced"},$e={class:"form-group"},Se={class:"form-group"},Be={key:0,class:"error"},Pe={class:"actions"},Te=["disabled"],qe=["disabled"],Ee={key:0,class:"preview-panel"},Ge={class:"preview-header"},Le={class:"file-list"},Me={class:"file-path"},Ne={key:0,class:"message"},Ie=A({__name:"DomainEditor",setup(je){const v=r(!1),c=r(null),b=r(""),k=r(!1),B=r([]),h=r([]),y=r("new"),V=r(!1),x=r(null),_=r(""),s=r({name:"",fields:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!0,force:!1}),U=O(()=>{if(!h.value||!_.value.trim())return h.value||[];const l=_.value.toLowerCase();return h.value.filter(e=>e.name.toLowerCase().includes(l)||e.fields.some(a=>a.toLowerCase().includes(l)))});z(async()=>{try{const l=await g.getFieldTypes();B.value=l.types,await F()}catch(l){console.error(l)}});async function F(){V.value=!0;try{const l=await g.listDomains();h.value=l.domains}catch(l){console.error("Failed to load domains:",l)}finally{V.value=!1}}async function T(l,e){if(e.stopPropagation(),!!confirm(`ç¡®å®šè¦åˆ é™¤é¢†åŸŸæ¨¡å— "${l}" å—ï¼Ÿ

è¿™å°†åˆ é™¤æ•´ä¸ªç›®å½•åŠå…¶æ‰€æœ‰æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`))try{await g.deleteDomain(l),await F()}catch(a){alert(`åˆ é™¤å¤±è´¥: ${a.message}`)}}async function q(l){v.value=!0,b.value="";try{const e=await g.getDomainDetail(l),a=e.fields.map(d=>{let i=E(d.type);return{name:d.snake_name,type:i,enum_values:d.is_enum?[]:void 0}});s.value={name:e.name,fields:a.length>0?a:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!1,force:!0},x.value=l,y.value="new"}catch(e){b.value=`åŠ è½½å¤±è´¥: ${e.message}`}finally{v.value=!1}}function E(l){return l=l.replace("*",""),l==="string"?"string":l==="int"?"int":l==="int64"?"int64":l==="float64"?"float64":l==="bool"?"bool":l==="time.Time"?"time":l.includes("Time")?"time?":"enum"}function G(){s.value.fields.push({name:"",type:"string",enum_values:[]})}function L(l){s.value.fields.length>1&&s.value.fields.splice(l,1)}function M(l,e){l.enum_values=e.split("|").map(a=>a.trim()).filter(Boolean)}async function N(){b.value="",v.value=!0;try{const l=s.value.fields.filter(e=>e.name.trim());c.value=await g.previewDomain({...s.value,fields:l}),k.value=!0}catch(l){b.value=l.message}finally{v.value=!1}}async function I(){b.value="",v.value=!0;try{const l=s.value.fields.filter(e=>e.name&&e.type);c.value=await g.generateDomain({...s.value,fields:l}),k.value=!0,await F(),c.value.success&&J(c.value.message||"ç”ŸæˆæˆåŠŸï¼")}catch(l){b.value=l.message}finally{v.value=!1}}function P(){s.value={name:"",fields:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!0,force:!1},c.value=null,k.value=!1,x.value=null}function j(l){return{new:"æ–°å»º",overwrite:"è¦†ç›–",skip:"è·³è¿‡",error:"é”™è¯¯"}[l]||l}return(l,e)=>(o(),n("div",K,[e[25]||(e[25]=t("h1",null,"ğŸ“¦ ç”Ÿæˆé¢†åŸŸæ¨¡å— Domain",-1)),t("div",W,[t("button",{class:$(["tab",{active:y.value==="new"}]),onClick:e[0]||(e[0]=a=>y.value="new")}," âœ¨ æ–°å»ºæ¨¡å— ",2),t("button",{class:$(["tab",{active:y.value==="existing"}]),onClick:e[1]||(e[1]=a=>y.value="existing")}," ğŸ“‹ å·²ç”Ÿæˆæ¨¡å— ("+u(h.value?.length||0)+") ",3)]),y.value==="existing"?(o(),n("div",X,[t("div",Y,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>_.value=a),type:"text",placeholder:"ğŸ” æœç´¢é¢†åŸŸæ¨¡å—æˆ–å­—æ®µ...",class:"search-input"},null,512),[[w,_.value]]),_.value?(o(),n("span",{key:0,class:"search-clear",onClick:e[3]||(e[3]=a=>_.value="")},"âœ•")):m("",!0)]),V.value?(o(),n("div",Z,"åŠ è½½ä¸­...")):U.value.length===0&&!_.value?(o(),n("div",ee,[...e[11]||(e[11]=[t("p",null,"æš‚æ— å·²ç”Ÿæˆçš„é¢†åŸŸæ¨¡å—",-1),t("p",{class:"hint"},'ç‚¹å‡»"æ–°å»ºæ¨¡å—"å¼€å§‹åˆ›å»º',-1)])])):U.value.length===0&&_.value?(o(),n("div",te,[...e[12]||(e[12]=[t("p",null,"æœªæ‰¾åˆ°åŒ¹é…çš„æ¨¡å—",-1),t("p",{class:"hint"},"å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):(o(),n("div",ae,[(o(!0),n(C,null,D(U.value,a=>(o(),n("div",{key:a.name,class:"domain-card",onClick:d=>q(a.name)},[t("div",se,[t("h3",null,u(a.name),1),t("div",ne,[t("span",oe,u(a.fields?.length||0)+" å­—æ®µ",1),t("button",{class:"btn-delete",onClick:d=>T(a.name,d),title:"åˆ é™¤æ¨¡å—"}," ğŸ—‘ï¸ ",8,ie)])]),t("div",ue,[(o(!0),n(C,null,D(a.fields,(d,i)=>(o(),n("span",{key:i,class:"field-tag"},u(d),1))),128))]),e[13]||(e[13]=t("div",{class:"domain-action"}," ç‚¹å‡»ç¼–è¾‘ â†’ ",-1))],8,le))),128))]))])):m("",!0),y.value==="new"?(o(),n("div",de,[x.value?(o(),n("div",re,[e[14]||(e[14]=f(" âœï¸ æ­£åœ¨ç¼–è¾‘: ",-1)),t("strong",null,u(x.value),1),t("button",{class:"btn-small",onClick:P},"å–æ¶ˆç¼–è¾‘")])):m("",!0),t("div",ve,[t("div",ce,[e[24]||(e[24]=Q('<details class="help-tips" data-v-71a19b44><summary data-v-71a19b44>ğŸ“– ä½¿ç”¨æŒ‡å— Usage Guide</summary><div class="tips-content" data-v-71a19b44><p data-v-71a19b44><strong data-v-71a19b44>é¢†åŸŸåç§°ï¼š</strong>ä½¿ç”¨ PascalCase æ ¼å¼ï¼Œå¦‚ <code data-v-71a19b44>User</code>ã€<code data-v-71a19b44>Order</code></p><p data-v-71a19b44><strong data-v-71a19b44>å­—æ®µç±»å‹ï¼š</strong></p><ul data-v-71a19b44><li data-v-71a19b44><code data-v-71a19b44>string</code> - å­—ç¬¦ä¸² (varchar 255)</li><li data-v-71a19b44><code data-v-71a19b44>text</code> - é•¿æ–‡æœ¬</li><li data-v-71a19b44><code data-v-71a19b44>int</code> / <code data-v-71a19b44>int64</code> - æ•´æ•°</li><li data-v-71a19b44><code data-v-71a19b44>time</code> - æ—¶é—´æˆ³ï¼Œ<code data-v-71a19b44>time?</code> - å¯é€‰æ—¶é—´</li><li data-v-71a19b44><code data-v-71a19b44>enum</code> - æšä¸¾ç±»å‹ï¼Œéœ€å¡«å†™æšä¸¾å€¼ï¼ˆç”¨ | åˆ†éš”ï¼‰</li></ul><p data-v-71a19b44><strong data-v-71a19b44>æç¤ºï¼š</strong>å‹¾é€‰&quot;è‡ªåŠ¨æ³¨å…¥åˆ° main.go&quot;å¯è‡ªåŠ¨å®Œæˆæ¨¡å—æ³¨å†Œï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ä»£ç </p></div></details>',1)),t("div",me,[e[15]||(e[15]=t("label",null,[f(" é¢†åŸŸåç§° Domain Name * "),t("span",{class:"tooltip","data-tooltip":"å®ä½“åç§°ï¼Œå°†ç”Ÿæˆå¯¹åº”çš„ Go ç»“æ„ä½“"},"â“˜")],-1)),p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.name=a),placeholder:"User / Order / Product"},null,512),[[w,s.value.name]])]),t("div",pe,[t("div",{class:"section-header"},[e[16]||(e[16]=t("h3",null,"å­—æ®µ Fields",-1)),t("button",{class:"btn-add",onClick:G},"+ æ·»åŠ å­—æ®µ")]),(o(!0),n(C,null,D(s.value.fields,(a,d)=>(o(),n("div",{class:"field-row",key:d},[p(t("input",{"onUpdate:modelValue":i=>a.name=i,placeholder:"username / email / status",class:"field-name"},null,8,fe),[[w,a.name]]),p(t("select",{"onUpdate:modelValue":i=>a.type=i,class:"field-type"},[(o(!0),n(C,null,D(B.value,i=>(o(),n("option",{key:i.type,value:i.type},u(i.type)+" - "+u(i.description),9,_e))),128))],8,be),[[R,a.type]]),a.type==="enum"?(o(),n("input",{key:0,value:a.enum_values?.join("|"),onInput:i=>M(a,i.target.value),placeholder:"active|inactive|banned",class:"field-enum","data-tooltip":"æšä¸¾å€¼ç”¨ | åˆ†éš”ï¼Œå¦‚ï¼šactive|inactive"},null,40,ye)):m("",!0),t("button",{class:"btn-remove",onClick:i=>L(d),disabled:s.value.fields.length===1},"Ã—",8,ge)]))),128))]),t("div",ke,[t("div",he,[t("label",we,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>s.value.soft_delete=a)},null,512),[[S,s.value.soft_delete]]),e[17]||(e[17]=f(" å¯ç”¨è½¯åˆ é™¤ Soft Delete ",-1))])]),t("div",Ce,[t("label",De,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>s.value.wire=a)},null,512),[[S,s.value.wire]]),e[18]||(e[18]=f(" è‡ªåŠ¨æ³¨å…¥åˆ° main.go ",-1))])]),t("div",xe,[t("label",Ve,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=a=>s.value.force=a)},null,512),[[S,s.value.force]]),e[19]||(e[19]=f(" å¼ºåˆ¶è¦†ç›– Force ",-1))]),s.value.force?(o(),n("div",Ue,[...e[20]||(e[20]=[f(" âš ï¸ ",-1),t("strong",null,"è­¦å‘Šï¼š",-1),f("å¼ºåˆ¶è¦†ç›–å°†",-1),t("strong",null,"æ°¸ä¹…åˆ é™¤",-1),f("æ‰€æœ‰æ‰‹åŠ¨ä¿®æ”¹çš„ä»£ç ï¼",-1),t("br",null,null,-1),f(" åªåœ¨é¦–æ¬¡ç”Ÿæˆåç«‹å³ä¿®æ”¹å­—æ®µæ—¶ä½¿ç”¨ã€‚ä¸€æ—¦å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¯·å‹¿å‹¾é€‰æ­¤é€‰é¡¹ã€‚ ",-1)])])):m("",!0)])]),t("details",Fe,[e[23]||(e[23]=t("summary",null,"é«˜çº§é€‰é¡¹ Advanced",-1)),t("div",$e,[e[21]||(e[21]=t("label",null,"è‡ªå®šä¹‰è¡¨å Table Name",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>s.value.table_name=a),placeholder:"ï¼ˆè‡ªåŠ¨ï¼šåç§°çš„å¤æ•°å½¢å¼ï¼‰"},null,512),[[w,s.value.table_name]])]),t("div",Se,[e[22]||(e[22]=t("label",null,"è‡ªå®šä¹‰è·¯ç”±å‰ç¼€ Route Base",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>s.value.route_base=a),placeholder:"ï¼ˆè‡ªåŠ¨ï¼šåç§°çš„å¤æ•°å½¢å¼ï¼‰"},null,512),[[w,s.value.route_base]])])]),b.value?(o(),n("div",Be,u(b.value),1)):m("",!0),t("div",Pe,[t("button",{class:"btn",onClick:N,disabled:!s.value.name||v.value},u(v.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview"),9,Te),t("button",{class:"btn primary",onClick:I,disabled:!s.value.name||v.value},u(v.value?"ç”Ÿæˆä¸­...":"ç”Ÿæˆ Generate"),9,qe)])]),k.value&&c.value?(o(),n("div",Ee,[t("div",Ge,[t("h3",null,u(c.value.success?"âœ… å·²ç”Ÿæˆæ–‡ä»¶":"âŒ é”™è¯¯"),1),t("button",{class:"btn-close",onClick:e[10]||(e[10]=a=>k.value=!1)},"Ã—")]),t("div",Le,[(o(!0),n(C,null,D(c.value.files,a=>(o(),n("div",{class:"file",key:a.path},[t("span",{class:$(["file-status",a.status])},u(j(a.status)),3),t("span",Me,u(a.path.split("/").pop()),1)]))),128))]),c.value.message?(o(),n("div",Ne,u(c.value.message),1)):m("",!0),t("button",{class:"btn primary",onClick:P,style:{width:"100%","margin-top":"16px"}}," ç”Ÿæˆå¦ä¸€ä¸ª ")])):m("",!0)])])):m("",!0)]))}}),Qe=H(Ie,[["__scopeId","data-v-71a19b44"]]);export{Qe as default};
