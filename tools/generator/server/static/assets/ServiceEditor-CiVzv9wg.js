import{d as z,r as d,k as A,o as I,u as Q,c as o,a as e,b as v,n as k,t as n,l as w,v as P,F as T,f as V,j as b,e as H,p as J,i}from"./index-CUp5w2Mf.js";import{a as _,_ as K}from"./_plugin-vue_export-helper-BkqGbvhh.js";import{s as W}from"./toast-DWcfC-h2.js";const X={class:"editor"},Y={class:"tabs"},Z={key:0,class:"services-list"},ee={class:"search-box"},te={key:0,class:"loading"},ae={key:1,class:"empty"},se={key:2,class:"empty"},le={key:3,class:"service-grid"},oe=["onClick"],ie={class:"service-header"},ne={class:"service-title"},de={key:0,class:"service-remark"},ve={class:"header-actions"},re={class:"badge"},ue=["onClick"],ce={class:"service-methods"},be={key:1},me={key:0,class:"editing-banner"},pe={class:"layout"},he={class:"form-panel"},ge={class:"form-group"},_e={class:"form-group"},fe={key:0,class:"detection-result"},ye={class:"detection-header"},ke={class:"detection-icon"},we={class:"detection-content"},Se={class:"detection-message"},Ce={class:"detection-details"},xe={class:"detail-item"},Pe={class:"detail-item"},Te={key:0,class:"detail-item highlight"},Ve={class:"methods-section"},$e=["onUpdate:modelValue"],Me=["onClick","disabled"],De={class:"options"},Le={class:"form-group inline"},Ue={"data-tooltip":"è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶"},Ne={key:0,class:"force-warning"},Oe={key:1,class:"error"},Fe={class:"actions"},Re=["disabled"],Ge=["disabled"],Be={key:0,class:"preview-panel"},Ee={class:"preview-header"},je={class:"file-list"},qe={class:"file-path"},ze={key:0,class:"message"},Ae=z({__name:"ServiceEditor",setup(Ie){const r=d(!1),u=d(null),m=d(""),f=d(!1),y=d([]),h=d("new"),$=d(!1),S=d(null),p=d(""),g=d(null),C=d(!1),M=d(!1),l=d({name:"",remark:"",methods:[""],force:!1}),D=A(()=>{if(!y.value||!p.value.trim())return y.value||[];const s=p.value.toLowerCase();return y.value.filter(t=>t.name.toLowerCase().includes(s)||(t.remark||"").toLowerCase().includes(s)||t.methods.some(a=>a.toLowerCase().includes(s)))});I(async()=>{await L()});async function L(){$.value=!0;try{const s=await _.listServices();y.value=s.services}catch(s){console.error("Failed to load services:",s)}finally{$.value=!1}}async function O(s,t){if(t.stopPropagation(),!!confirm(`ç¡®å®šè¦åˆ é™¤åº”ç”¨æœåŠ¡ "${s}" å—ï¼Ÿ

è¿™å°†åˆ é™¤æœåŠ¡æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`))try{await _.deleteService(s),await L()}catch(a){alert(`åˆ é™¤å¤±è´¥: ${a.message}`)}}async function F(){if(!l.value.name||l.value.name.trim()===""){C.value=!1;return}try{const s=await _.detectServiceType(l.value.name);g.value=s,C.value=!0}catch(s){console.error("æ£€æµ‹å¤±è´¥:",s),C.value=!1}}let U=null;Q(()=>l.value.name,()=>{U&&clearTimeout(U),U=setTimeout(F,500)});async function R(s){r.value=!0,m.value="";try{const t=await _.getServiceDetail(s);l.value={name:t.name,remark:t.remark||"",methods:t.methods.map(a=>a.name),force:!0},S.value=s,h.value="new"}catch(t){m.value=`åŠ è½½å¤±è´¥: ${t.message}`}finally{r.value=!1}}function G(){l.value.methods.push("")}function B(s){l.value.methods.length>1&&l.value.methods.splice(s,1)}async function E(){m.value="",r.value=!0;try{const s=l.value.methods.filter(t=>t.trim());u.value=await _.previewService({...l.value,methods:s}),f.value=!0}catch(s){m.value=s.message}finally{r.value=!1}}async function j(){m.value="",r.value=!0;try{const s=l.value.methods.filter(t=>t.trim());u.value=await _.generateService({...l.value,methods:s}),f.value=!0,await L(),u.value.success&&W(u.value.message||"ç”ŸæˆæˆåŠŸï¼")}catch(s){m.value=s.message}finally{r.value=!1}}function N(){l.value={name:"",remark:"",methods:[""],force:!1},u.value=null,f.value=!1,S.value=null}function q(s){return{new:"æ–°å»º",overwrite:"è¦†ç›–",skip:"è·³è¿‡",error:"é”™è¯¯"}[s]||s}return(s,t)=>(i(),o("div",X,[t[25]||(t[25]=e("h1",null,"âš™ï¸ ç”Ÿæˆåº”ç”¨æœåŠ¡ Service",-1)),e("div",Y,[e("button",{class:k(["tab",{active:h.value==="new"}]),onClick:t[0]||(t[0]=a=>h.value="new")}," âœ¨ æ–°å»ºæœåŠ¡ ",2),e("button",{class:k(["tab",{active:h.value==="existing"}]),onClick:t[1]||(t[1]=a=>h.value="existing")}," ğŸ“‹ å·²ç”ŸæˆæœåŠ¡ ("+n(y.value?.length||0)+") ",3)]),h.value==="existing"?(i(),o("div",Z,[e("div",ee,[w(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>p.value=a),type:"text",placeholder:"ğŸ” æœç´¢åº”ç”¨æœåŠ¡æˆ–æ–¹æ³•...",class:"search-input"},null,512),[[P,p.value]]),p.value?(i(),o("span",{key:0,class:"search-clear",onClick:t[3]||(t[3]=a=>p.value="")},"âœ•")):v("",!0)]),$.value?(i(),o("div",te,"åŠ è½½ä¸­...")):D.value.length===0&&!p.value?(i(),o("div",ae,[...t[9]||(t[9]=[e("p",null,"æš‚æ— å·²ç”Ÿæˆçš„åº”ç”¨æœåŠ¡",-1),e("p",{class:"hint"},'ç‚¹å‡»"æ–°å»ºæœåŠ¡"å¼€å§‹åˆ›å»º',-1)])])):D.value.length===0&&p.value?(i(),o("div",se,[...t[10]||(t[10]=[e("p",null,"æœªæ‰¾åˆ°åŒ¹é…çš„æœåŠ¡",-1),e("p",{class:"hint"},"å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):(i(),o("div",le,[(i(!0),o(T,null,V(D.value,a=>(i(),o("div",{key:a.name,class:k(["service-card",{"domain-service":a.type==="domain_service","cross-domain-service":a.type==="cross_domain_service"}]),onClick:c=>R(a.name)},[e("div",ie,[e("div",ne,[e("h3",null,n(a.name),1),a.remark?(i(),o("span",de,n(a.remark),1)):v("",!0)]),e("div",ve,[e("span",{class:k(["type-badge",a.type])},n(a.type==="domain_service"?"é¢†åŸŸ":"è·¨åŸŸ"),3),e("span",re,n(a.methods?.length||0)+" æ–¹æ³•",1),e("button",{class:"btn-delete",onClick:c=>O(a.name,c),title:"åˆ é™¤æœåŠ¡"}," ğŸ—‘ï¸ ",8,ue)])]),e("div",ce,[(i(!0),o(T,null,V(a.methods,(c,x)=>(i(),o("span",{key:x,class:"method-tag"},n(c),1))),128))]),t[11]||(t[11]=e("div",{class:"service-action"}," ç‚¹å‡»ç¼–è¾‘ â†’ ",-1))],10,oe))),128))]))])):v("",!0),h.value==="new"?(i(),o("div",be,[S.value?(i(),o("div",me,[t[12]||(t[12]=b(" âœï¸ æ­£åœ¨ç¼–è¾‘: ",-1)),e("strong",null,n(S.value),1),e("button",{class:"btn-small",onClick:N},"å–æ¶ˆç¼–è¾‘")])):v("",!0),e("div",pe,[e("div",he,[t[23]||(t[23]=H('<details class="help-tips" data-v-b1be1b61><summary data-v-b1be1b61>ğŸ“– ä½¿ç”¨æŒ‡å— Usage Guide</summary><div class="tips-content" data-v-b1be1b61><div class="tip-section" data-v-b1be1b61><h4 data-v-b1be1b61>ğŸ¯ ä»€ä¹ˆæ˜¯åº”ç”¨æœåŠ¡ (Application Service)?</h4><p data-v-b1be1b61>åº”ç”¨æœåŠ¡æ˜¯ DDD æ¶æ„ä¸­çš„<strong data-v-b1be1b61>åº”ç”¨å±‚ç»„ä»¶</strong>ï¼Œè´Ÿè´£ï¼š</p><ul data-v-b1be1b61><li data-v-b1be1b61>ç¼–æ’å¤šä¸ªé¢†åŸŸæ¨¡å‹ä¹‹é—´çš„ä¸šåŠ¡é€»è¾‘</li><li data-v-b1be1b61>å¤„ç†è·¨é¢†åŸŸçš„å¤æ‚æ“ä½œï¼ˆå¦‚ï¼šæ”¯ä»˜æ—¶æ›´æ–°è®¢å•çŠ¶æ€+æ‰£å‡åº“å­˜+å‘é€é€šçŸ¥ï¼‰</li><li data-v-b1be1b61>ä½œä¸ºé¢†åŸŸå±‚å’Œæ¥å£å±‚ä¹‹é—´çš„æ¡¥æ¢</li></ul></div><div class="tip-section" data-v-b1be1b61><h4 data-v-b1be1b61>ğŸ“ æœåŠ¡åç§°è§„åˆ™</h4><ul data-v-b1be1b61><li data-v-b1be1b61>ä½¿ç”¨ <strong data-v-b1be1b61>PascalCase</strong> æ ¼å¼</li><li data-v-b1be1b61>å»ºè®®ä»¥ <code data-v-b1be1b61>Service</code> ç»“å°¾ï¼ˆä¸å¡«ä¼šè‡ªåŠ¨æ·»åŠ ï¼‰</li><li data-v-b1be1b61>ç¤ºä¾‹ï¼š<code data-v-b1be1b61>PaymentService</code>ã€<code data-v-b1be1b61>OrderProcessService</code>ã€<code data-v-b1be1b61>NotificationService</code></li></ul></div><div class="tip-section" data-v-b1be1b61><h4 data-v-b1be1b61>âš™ï¸ ä¸¤ç§æœåŠ¡ç±»å‹</h4><ul data-v-b1be1b61><li data-v-b1be1b61><span class="type-hint domain" data-v-b1be1b61>é¢†åŸŸæœåŠ¡</span> - ä¸å·²æœ‰é¢†åŸŸåŒåæ—¶ï¼Œç”Ÿæˆåœ¨ <code data-v-b1be1b61>application/{domain}/service.go</code></li><li data-v-b1be1b61><span class="type-hint cross" data-v-b1be1b61>è·¨åŸŸæœåŠ¡</span> - æ— å¯¹åº”é¢†åŸŸæ—¶ï¼Œç”Ÿæˆåœ¨ç‹¬ç«‹ç›®å½• <code data-v-b1be1b61>application/{service}/</code></li></ul></div><div class="tip-section" data-v-b1be1b61><h4 data-v-b1be1b61>ğŸ“‹ æ–¹æ³•å®šä¹‰</h4><ul data-v-b1be1b61><li data-v-b1be1b61>æ¯è¡Œè¾“å…¥ä¸€ä¸ªæ–¹æ³•åï¼Œä½¿ç”¨ PascalCase</li><li data-v-b1be1b61>ç¤ºä¾‹ï¼š<code data-v-b1be1b61>ProcessPayment</code>ã€<code data-v-b1be1b61>RefundOrder</code>ã€<code data-v-b1be1b61>SendNotification</code></li><li data-v-b1be1b61><strong data-v-b1be1b61>ç•™ç©º</strong>å°†è‡ªåŠ¨ç”Ÿæˆï¼šCreateã€Getã€List ä¸‰ä¸ªåŸºç¡€æ–¹æ³•</li></ul></div><div class="tip-section" data-v-b1be1b61><h4 data-v-b1be1b61>ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶</h4><ul data-v-b1be1b61><li data-v-b1be1b61><code data-v-b1be1b61>service.go</code> - æœåŠ¡ä¸»ä½“ï¼ŒåŒ…å«æ–¹æ³•ç­¾åå’Œæ¡©ä»£ç </li><li data-v-b1be1b61><code data-v-b1be1b61>service_dto.go</code> - è¯·æ±‚/å“åº”çš„æ•°æ®ä¼ è¾“å¯¹è±¡</li><li data-v-b1be1b61><code data-v-b1be1b61>module.go</code> - Fx ä¾èµ–æ³¨å…¥æ¨¡å—</li></ul></div><div class="tip-section warning" data-v-b1be1b61><h4 data-v-b1be1b61>âš ï¸ æ³¨æ„äº‹é¡¹</h4><ul data-v-b1be1b61><li data-v-b1be1b61>ç”Ÿæˆåéœ€è¦åœ¨ <code data-v-b1be1b61>service.go</code> ä¸­æ³¨å…¥æ‰€éœ€çš„ Repository</li><li data-v-b1be1b61>æ–¹æ³•ä½“ä¸ºç©ºå®ç°ï¼Œéœ€æ‰‹åŠ¨å¡«å……ä¸šåŠ¡é€»è¾‘</li><li data-v-b1be1b61>ä½¿ç”¨<strong data-v-b1be1b61>å¼ºåˆ¶è¦†ç›–</strong>ä¼šä¸¢å¤±å·²æœ‰ä»£ç ï¼ä»…åœ¨é¦–æ¬¡ç”Ÿæˆæˆ–é‡ç½®æ—¶ä½¿ç”¨</li></ul></div></div></details>',1)),e("div",ge,[t[13]||(t[13]=e("label",null,[b(" æœåŠ¡åç§° Service Name * "),e("span",{class:"tooltip","data-tooltip":"åº”ç”¨æœåŠ¡åç§°ï¼Œç”¨äºè·¨é¢†åŸŸä¸šåŠ¡é€»è¾‘"},"â“˜")],-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.name=a),placeholder:"OrderService / PaymentService"},null,512),[[P,l.value.name]]),t[14]||(t[14]=e("span",{class:"hint"},'å¦‚æœæœªåŒ…å« "Service" åç¼€ä¼šè‡ªåŠ¨æ·»åŠ ',-1))]),e("div",_e,[t[15]||(t[15]=e("label",null,"æœåŠ¡å¤‡æ³¨ Remarkï¼ˆå¯é€‰ï¼‰",-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.remark=a),placeholder:"ç”¨äºè¯´æ˜è¯¥æœåŠ¡ç”¨é€”"},null,512),[[P,l.value.remark]]),t[16]||(t[16]=e("span",{class:"hint"},"ä¼šæ˜¾ç¤ºåœ¨å·²ç”ŸæˆæœåŠ¡å¡ç‰‡ä¸Š",-1))]),C.value&&g.value?(i(),o("div",fe,[e("div",ye,[e("div",ke,n(g.value.domain_exists?"âœ…":"â„¹ï¸"),1),e("div",we,[e("p",Se,n(g.value.message),1),e("div",Ce,[e("span",xe,[t[17]||(t[17]=e("strong",null,"ç±»å‹:",-1)),b(" "+n(g.value.service_type==="domain_service"?"é¢†åŸŸæœåŠ¡":"è·¨é¢†åŸŸæœåŠ¡"),1)]),e("span",Pe,[t[18]||(t[18]=e("strong",null,"ç›®æ ‡:",-1)),b(" "+n(g.value.target_dir),1)]),g.value.should_reuse_dto?(i(),o("span",Te," âœ… å¤ç”¨ç°æœ‰ DTO ")):v("",!0)])]),e("button",{class:"btn-toggle-manual",onClick:t[6]||(t[6]=a=>M.value=!M.value),type:"button"},n(M.value?"ğŸ”„ è‡ªåŠ¨":"âš™ï¸ æ‰‹åŠ¨"),1)])])):v("",!0),e("div",Ve,[e("div",{class:"section-header"},[t[19]||(t[19]=e("h3",null,"æ–¹æ³• Methods",-1)),e("button",{class:"btn-add",onClick:G},"+ æ·»åŠ æ–¹æ³•")]),(i(!0),o(T,null,V(l.value.methods,(a,c)=>(i(),o("div",{class:"method-row",key:c},[w(e("input",{"onUpdate:modelValue":x=>l.value.methods[c]=x,placeholder:"CreateOrder / ProcessPayment / CancelOrder",class:"method-name"},null,8,$e),[[P,l.value.methods[c]]]),e("button",{class:"btn-remove",onClick:x=>B(c),disabled:l.value.methods.length===1},"Ã—",8,Me)]))),128)),t[20]||(t[20]=e("p",{class:"hint"},"ç•™ç©ºå°†ç”Ÿæˆé»˜è®¤æ–¹æ³•ï¼šCreateã€Getã€List",-1))]),e("div",De,[e("div",Le,[e("label",Ue,[w(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=a=>l.value.force=a)},null,512),[[J,l.value.force]]),t[21]||(t[21]=b(" å¼ºåˆ¶è¦†ç›– Force ",-1))]),l.value.force?(i(),o("div",Ne,[...t[22]||(t[22]=[b(" âš ï¸ ",-1),e("strong",null,"è­¦å‘Šï¼š",-1),b("å¼ºåˆ¶è¦†ç›–å°†",-1),e("strong",null,"æ°¸ä¹…åˆ é™¤",-1),b("æ‰€æœ‰æ‰‹åŠ¨ä¿®æ”¹çš„ä»£ç ï¼",-1),e("br",null,null,-1),b(" åªåœ¨é¦–æ¬¡ç”Ÿæˆåç«‹å³ä¿®æ”¹æ—¶ä½¿ç”¨ã€‚ä¸€æ—¦å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¯·å‹¿å‹¾é€‰æ­¤é€‰é¡¹ã€‚ ",-1)])])):v("",!0)])]),m.value?(i(),o("div",Oe,n(m.value),1)):v("",!0),e("div",Fe,[e("button",{class:"btn",onClick:E,disabled:!l.value.name||r.value},n(r.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview"),9,Re),e("button",{class:"btn primary",onClick:j,disabled:!l.value.name||r.value},n(r.value?"ç”Ÿæˆä¸­...":"ç”Ÿæˆ Generate"),9,Ge)])]),f.value&&u.value?(i(),o("div",Be,[e("div",Ee,[e("h3",null,n(u.value.success?"âœ… å·²ç”Ÿæˆæ–‡ä»¶":"âŒ é”™è¯¯"),1),e("button",{class:"btn-close",onClick:t[8]||(t[8]=a=>f.value=!1)},"Ã—")]),e("div",je,[(i(!0),o(T,null,V(u.value.files,a=>(i(),o("div",{class:"file",key:a.path},[e("span",{class:k(["file-status",a.status])},n(q(a.status)),3),e("span",qe,n(a.path.split("/").pop()),1)]))),128))]),u.value.message?(i(),o("div",ze,n(u.value.message),1)):v("",!0),t[24]||(t[24]=e("div",{class:"next-steps"},[e("h4",null,"ä¸‹ä¸€æ­¥ Next Steps:"),e("ol",null,[e("li",null,"åœ¨æœåŠ¡ç»“æ„ä½“ä¸­æ³¨å…¥æ‰€éœ€çš„ Repository"),e("li",null,"åœ¨æ¯ä¸ªæ–¹æ³•ä¸­å®ç°ä¸šåŠ¡é€»è¾‘"),e("li",null,"åœ¨ main.go ä¸­æ³¨å†ŒæœåŠ¡")])],-1)),e("button",{class:"btn primary",onClick:N,style:{width:"100%","margin-top":"16px"}}," ç”Ÿæˆå¦ä¸€ä¸ª ")])):v("",!0)])])):v("",!0)]))}}),Ke=K(Ae,[["__scopeId","data-v-b1be1b61"]]);export{Ke as default};
