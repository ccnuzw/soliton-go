import{d as at,r as c,k as Se,o as lt,u as nt,c as u,e as st,a,b as O,j as A,l as v,v as w,F as E,f as V,s as T,t as d,p as W,n as oe,i as r}from"./index-CUp5w2Mf.js";import{a as b,_ as it}from"./_plugin-vue_export-helper-BkqGbvhh.js";import{a as o,s as S}from"./toast-DWcfC-h2.js";const ot={class:"editor"},ut={class:"domain-select"},rt={class:"domain-input"},dt={id:"domain-list"},vt=["value"],ct=["value"],ft=["disabled"],mt={class:"hint"},pt={class:"grid"},gt={class:"card"},bt={class:"existing"},yt={class:"existing-row"},ht=["value"],_t={class:"existing-actions"},wt=["disabled"],kt=["disabled"],Et=["disabled"],Vt={class:"form-group"},St={class:"fields-section"},Dt={class:"section-header"},Ft=["onUpdate:modelValue"],Ct=["onUpdate:modelValue"],xt=["value"],Ut=["value","onInput"],Ot=["onUpdate:modelValue"],jt=["onClick","disabled"],Ht={class:"batch-import"},Pt={class:"checkbox"},$t={class:"actions"},Bt=["disabled"],Nt=["disabled"],Tt=["disabled"],Jt={key:0,class:"result"},At={class:"result-header"},Lt={class:"file-list"},It={class:"file-path"},Rt={class:"card"},Mt={class:"existing"},Gt={class:"existing-row"},zt=["value"],Wt={class:"existing-actions"},qt=["disabled"],Kt=["disabled"],Qt=["disabled"],Xt={class:"form-group"},Yt={class:"form-group"},Zt=["placeholder"],ea={class:"checkbox"},ta={class:"batch-import"},aa={class:"actions"},la=["disabled"],na=["disabled"],sa=["disabled"],ia={key:0,class:"result"},oa={class:"result-header"},ua={class:"file-list"},ra={class:"file-path"},da={class:"card"},va={class:"existing"},ca={class:"existing-row"},fa=["value"],ma={class:"existing-actions"},pa=["disabled"],ga=["disabled"],ba=["disabled"],ya={class:"form-group"},ha={class:"form-group"},_a=["placeholder"],wa={class:"checkbox"},ka={class:"batch-import"},Ea={class:"actions"},Va=["disabled"],Sa=["disabled"],Da=["disabled"],Fa={key:0,class:"result"},Ca={class:"result-header"},xa={class:"file-list"},Ua={class:"file-path"},Oa={class:"card full"},ja={class:"existing"},Ha={class:"existing-row"},Pa=["value"],$a={class:"existing-actions"},Ba=["disabled"],Na=["disabled"],Ta=["disabled"],Ja={class:"existing"},Aa={class:"existing-row"},La=["value"],Ia={class:"existing-actions"},Ra=["disabled"],Ma=["disabled"],Ga=["disabled"],za={class:"form-group"},Wa={class:"form-group"},qa={key:0,class:"fields-section"},Ka={class:"section-header"},Qa=["onUpdate:modelValue"],Xa=["onUpdate:modelValue"],Ya=["value"],Za=["value","onInput"],el=["onUpdate:modelValue"],tl=["onClick","disabled"],al={class:"options-grid"},ll={class:"checkbox"},nl={class:"checkbox"},sl={class:"checkbox"},il={class:"checkbox"},ol={key:1,class:"form-group"},ul={class:"batch-import"},rl={class:"actions"},dl=["disabled"],vl=["disabled"],cl=["disabled"],fl=["disabled"],ml={key:2,class:"result"},pl={class:"result-header"},gl={class:"file-list"},bl={class:"file-path"},yl={key:0,class:"message"},hl={key:0,class:"diff-modal"},_l={class:"diff-panel"},wl={class:"diff-header"},kl={class:"diff-title"},El={class:"diff-meta"},Vl={key:0},Sl={key:1},Dl={key:2},Fl={key:0,class:"diff-switch"},Cl=["value"],xl={class:"diff-body"},Ul={class:"diff-column"},Ol={class:"diff-column"},jl=at({__name:"DddEditor",setup(Hl){const Z=c(!1),L=c([]),j=c(""),ue=c([]),I=c(null),f=c(!1),D=c(""),F=c(""),C=c(""),x=c(""),U=c(""),re=c(!1),ve=c(""),_=c(!1),ee=c(""),te=c(""),ae=c(""),le=c(""),ne=c([]),se=c(0),P=c(!1),R=c(null),$=c(!1),M=c(null),B=c(!1),G=c(null),H=c(!1),N=c(null),m=c({name:"",fields:[{name:"value",type:"string",comment:"",enum_values:[]}],force:!1}),p=c({name:"",target:"",force:!1}),g=c({name:"",target:"",force:!1}),n=c({name:"",topic:"",fields:[{name:"user_id",type:"uuid",comment:"",enum_values:[]}],generateEvent:!0,generateHandler:!0,handlerTopic:"",eventForce:!1,handlerForce:!1}),De=Se(()=>{if(!j.value.trim())return"请选择或输入已有领域名称";const l=j.value.trim().toLowerCase(),e=L.value.some(t=>t.toLowerCase()===l);return L.value.length>0&&!e?"未在项目中找到该领域，请先生成领域模块":"可选领域来自已生成模块"}),J=Se(()=>ne.value[se.value]);lt(async()=>{try{const l=await b.getFieldTypes();ue.value=l.types,await ce(),await q()}catch(l){console.error(l)}}),nt(j,async()=>{D.value="",F.value="",C.value="",x.value="",U.value="",await q()});async function ce(){Z.value=!0;try{const l=await b.listDomains();if(L.value=l.domains.map(e=>e.name),!j.value&&L.value.length>0){const e=L.value[0];e&&(j.value=e)}}catch(l){console.error("Failed to load domains:",l)}finally{Z.value=!1}}async function q(){const l=j.value.trim();if(!l){I.value=null;return}f.value=!0;try{I.value=await b.listDddComponents(l)}catch(e){console.error("Failed to load DDD list:",e)}finally{f.value=!1}}function y(){const l=j.value.trim();return l||(o("请先选择领域"),null)}function fe(l){l.push({name:"",type:"string",comment:"",enum_values:[]})}function me(l,e){l.length>1&&l.splice(e,1)}function pe(l,e){l.enum_values=e.split("|").map(t=>t.trim()).filter(Boolean)}function K(l){return{new:"新建",overwrite:"覆盖",skip:"跳过",error:"错误"}[l]||l}function ge(){re.value=!1}function Q(l,e){ve.value=l,ne.value=e,se.value=0,re.value=!0}function be(l){if(!l)return null;if(typeof l=="string")return ye(l);if(typeof l!="object"||!l.name||!l.type)return null;const e=Array.isArray(l.enum_values)?l.enum_values:Array.isArray(l.enumValues)?l.enumValues:[];return{name:String(l.name),type:String(l.type),comment:l.comment?String(l.comment):"",enum_values:e}}function ye(l){const e=l.trim();if(!e)return null;let t="",i="",s="";if(e.includes(",")){const h=e.split(",");t=(h[0]||"").trim(),i=(h[1]||"").trim(),s=h.slice(2).join(",").trim()}else if(e.includes("	")){const h=e.split("	");t=(h[0]||"").trim(),i=(h[1]||"").trim(),s=h.slice(2).join(" ").trim()}else{const h=e.match(/^(\S+)\s+(\S+)\s*(.*)$/);if(!h)return null;t=h[1]||"",i=h[2]||"",s=h[3]||""}if(!t||!i)return null;let k=[];return i.startsWith("enum:")&&(k=i.slice(5).split("|").map(h=>h.trim()).filter(Boolean),i="enum"),{name:t,type:i,comment:s||"",enum_values:k}}function de(l){return l.map(e=>({name:e.name||"",type:e.type||"string",comment:e.comment||"",enum_values:e.enum_values?[...e.enum_values]:[]}))}function he(l,e){return!l||l.length===0?e:de(l)}function _e(l){const e=l.trim();if(!e)return null;try{const i=JSON.parse(e);if(Array.isArray(i)){const s=i.map(be).filter(Boolean);return s.length?{fields:s}:null}if(i&&typeof i=="object"){const k=(Array.isArray(i.fields)?i.fields:[]).map(be).filter(Boolean);return{name:i.name||i.event_name,topic:i.topic,handlerTopic:i.handler_topic||i.handlerTopic,generateEvent:i.generateEvent,generateHandler:i.generateHandler,eventForce:i.eventForce,handlerForce:i.handlerForce,fields:k}}}catch{}const t=e.split(/\r?\n/).map(ye).filter(Boolean);return t.length?{fields:t}:null}function we(l){const e=l.trim();if(!e)return null;try{const s=JSON.parse(e);if(s&&typeof s=="object")return{name:s.name,target:s.target,force:s.force}}catch{}const t=e.split(/\r?\n/).find(s=>s.trim());if(!t)return null;if(t.includes(",")){const s=t.split(",");return{name:(s[0]||"").trim(),target:(s[1]||"").trim()}}const i=t.match(/^(\S+)\s+(\S+)\s*$/);return i?{name:i[1]||"",target:i[2]||""}:{name:t.trim(),target:""}}function Fe(){const l=_e(ee.value);if(!l){o("请输入有效的字段 JSON 或行列表");return}l.name&&(m.value.name=String(l.name)),l.fields?.length&&(m.value.fields=de(l.fields)),S("已导入字段")}function Ce(){ee.value=JSON.stringify({name:m.value.name,fields:m.value.fields},null,2)}function xe(){const l=we(te.value);if(!l){o("请输入有效的 JSON 或 Name,Target");return}l.name&&(p.value.name=String(l.name)),l.target!==void 0&&(p.value.target=l.target||""),typeof l.force=="boolean"&&(p.value.force=l.force),S("已导入 Specification 配置")}function Ue(){te.value=JSON.stringify({name:p.value.name,target:p.value.target,force:p.value.force},null,2)}function Oe(){const l=we(ae.value);if(!l){o("请输入有效的 JSON 或 Name,Target");return}l.name&&(g.value.name=String(l.name)),l.target!==void 0&&(g.value.target=l.target||""),typeof l.force=="boolean"&&(g.value.force=l.force),S("已导入 Policy 配置")}function je(){ae.value=JSON.stringify({name:g.value.name,target:g.value.target,force:g.value.force},null,2)}function He(){const l=_e(le.value);if(!l){o("请输入有效的字段 JSON 或行列表");return}l.name&&(n.value.name=String(l.name)),l.topic!==void 0&&(n.value.topic=l.topic||""),l.handlerTopic!==void 0&&(n.value.handlerTopic=l.handlerTopic||""),typeof l.generateEvent=="boolean"&&(n.value.generateEvent=l.generateEvent),typeof l.generateHandler=="boolean"&&(n.value.generateHandler=l.generateHandler),typeof l.eventForce=="boolean"&&(n.value.eventForce=l.eventForce),typeof l.handlerForce=="boolean"&&(n.value.handlerForce=l.handlerForce),l.fields?.length&&(n.value.fields=de(l.fields),n.value.generateEvent=!0),S("已导入 Event 配置")}function Pe(){le.value=JSON.stringify({name:n.value.name,topic:n.value.topic,handler_topic:n.value.handlerTopic,generateEvent:n.value.generateEvent,generateHandler:n.value.generateHandler,eventForce:n.value.eventForce,handlerForce:n.value.handlerForce,fields:n.value.fields},null,2)}function ke(l,e,t){l==="valueobject"&&(D.value===e&&(D.value=t),m.value.name===e&&(m.value.name=t)),l==="spec"&&(F.value===e&&(F.value=t),p.value.name===e&&(p.value.name=t)),l==="policy"&&(C.value===e&&(C.value=t),g.value.name===e&&(g.value.name=t)),l==="event"&&(x.value===e&&(x.value=t),n.value.name===e&&(n.value.name=t)),l==="event_handler"&&(U.value===e&&(U.value=t),n.value.name===e&&(n.value.name=t))}function $e(l,e){l==="valueobject"&&D.value===e&&(D.value=""),l==="spec"&&F.value===e&&(F.value=""),l==="policy"&&C.value===e&&(C.value=""),l==="event"&&x.value===e&&(x.value=""),l==="event_handler"&&U.value===e&&(U.value="")}async function X(l,e,t){const i=y();if(!i)return;if(!e){o(`请选择需要重命名的 ${t}`);return}const s=window.prompt(`请输入新的 ${t} 名称`,e);if(!(!s||!s.trim())){if(s.trim()===e){o("新名称与原名称一致");return}f.value=!0;try{await b.renameDddItem({domain:i,type:l,name:e,new_name:s.trim(),force:!1}),ke(l,e,s.trim()),await q(),S(`${t} 已重命名`)}catch(k){if(k?.message&&k.message.includes("target file exists")){if(!window.confirm("目标文件已存在，是否覆盖？"))return;try{await b.renameDddItem({domain:i,type:l,name:e,new_name:s.trim(),force:!0}),ke(l,e,s.trim()),await q(),S(`${t} 已覆盖重命名`)}catch(tt){o(tt?.message||"重命名失败")}}else o(k?.message||"重命名失败")}finally{f.value=!1}}}async function Y(l,e,t){const i=y();if(!i)return;if(!e){o(`请选择需要删除的 ${t}`);return}if(window.confirm(`确认删除 ${t} ${e} 吗？`)){f.value=!0;try{await b.deleteDddItem({domain:i,type:l,name:e}),$e(l,e),await q(),S(`${t} 已删除`)}catch(k){o(k?.message||"删除失败")}finally{f.value=!1}}}async function Be(l,e,t=""){try{const i=await b.getDddSource(l,e,t);return{content:i.content,file:i.file,found:!0}}catch{return{content:"",file:"",found:!1}}}function Ee(l){const e=l.files.filter(t=>t.content).map(t=>({content:t.content,file:t.path.split("/").pop()||t.path,status:t.status,path:t.path}));if(!e.length)throw new Error("预览内容为空");return e}function ie(l){const t=Ee(l)[0];if(!t)throw new Error("预览内容为空");return t}async function z(l,e,t,i){const s=await Be(l,e,t);return{fileName:i.file,existing:s.content,preview:i.content,status:i.status,hint:s.found?"":"当前文件不存在，将创建新文件"}}async function Ne(){const l=y();if(l){if(!m.value.name.trim()){o("请输入 Value Object 名称");return}_.value=!0;try{const e=m.value.fields.filter(k=>k.name.trim()),t=await b.previewValueObject({domain:l,name:m.value.name,fields:e,force:m.value.force}),i=ie(t),s=await z(l,"valueobject",m.value.name,i);Q(`Value Object · ${m.value.name}`,[s])}catch(e){o(e?.message||"对比失败")}finally{_.value=!1}}}async function Te(){const l=y();if(l){if(!p.value.name.trim()){o("请输入 Specification 名称");return}_.value=!0;try{const e=await b.previewSpecification({domain:l,name:p.value.name,target:p.value.target.trim(),force:p.value.force}),t=ie(e),i=await z(l,"spec",p.value.name,t);Q(`Specification · ${p.value.name}`,[i])}catch(e){o(e?.message||"对比失败")}finally{_.value=!1}}}async function Je(){const l=y();if(l){if(!g.value.name.trim()){o("请输入 Policy 名称");return}_.value=!0;try{const e=await b.previewPolicy({domain:l,name:g.value.name,target:g.value.target.trim(),force:g.value.force}),t=ie(e),i=await z(l,"policy",g.value.name,t);Q(`Policy · ${g.value.name}`,[i])}catch(e){o(e?.message||"对比失败")}finally{_.value=!1}}}async function Ae(){const l=y();if(l){if(!n.value.name.trim()){o("请输入 Event 名称");return}if(!n.value.generateEvent){o("请勾选生成 Event 后再对比");return}_.value=!0;try{const e=n.value.fields.filter(k=>k.name.trim()),t=await b.previewEvent({domain:l,name:n.value.name,fields:e,topic:n.value.topic.trim(),force:n.value.eventForce}),i=ie(t),s=await z(l,"event",n.value.name,i);Q(`Event · ${n.value.name}`,[s])}catch(e){o(e?.message||"对比失败")}finally{_.value=!1}}}async function Le(){const l=y();if(l){if(!n.value.name.trim()){o("请输入 Event 名称");return}if(!n.value.generateHandler){o("请勾选生成 Handler 后再对比");return}_.value=!0;try{const e=await b.previewEventHandler({domain:l,event_name:n.value.name,topic:(n.value.handlerTopic||n.value.topic).trim(),force:n.value.handlerForce}),t=Ee(e),i=[];for(const s of t){if(s.file==="module.go"){const h=await z(l,"module","",s);i.push(h);continue}if(s.file==="main.go"){const h=await z("","main","",s);i.push(h);continue}const k=await z(l,"event_handler",n.value.name,s);i.push(k)}if(i.length===0){o("预览内容为空");return}Q(`Handler · ${n.value.name}`,i)}catch(e){o(e?.message||"对比失败")}finally{_.value=!1}}}function Ve(l){const e={success:!0,files:[]},t=[],i=[];return l.forEach(s=>{e.success=e.success&&s.success,e.files.push(...s.files),s.message&&t.push(s.message),s.errors&&s.errors.length>0&&i.push(...s.errors)}),t.length>0&&(e.message=t.join(" / ")),i.length>0&&(e.errors=i),e}async function Ie(){const l=y();if(l){if(!D.value){o("请选择 Value Object");return}f.value=!0;try{const e=await b.getDddDetail(l,"valueobject",D.value);m.value.name=e.name||D.value,m.value.fields=he(e.fields,[{name:"value",type:"string",comment:"",enum_values:[]}]),m.value.force=!0,S("已加载 Value Object")}catch(e){o(e.message||"加载失败")}finally{f.value=!1}}}async function Re(){const l=y();if(l){if(!F.value){o("请选择 Specification");return}f.value=!0;try{const e=await b.getDddDetail(l,"spec",F.value);p.value.name=e.name||F.value,p.value.target=e.target||"",p.value.force=!0,S("已加载 Specification")}catch(e){o(e.message||"加载失败")}finally{f.value=!1}}}async function Me(){const l=y();if(l){if(!C.value){o("请选择 Policy");return}f.value=!0;try{const e=await b.getDddDetail(l,"policy",C.value);g.value.name=e.name||C.value,g.value.target=e.target||"",g.value.force=!0,S("已加载 Policy")}catch(e){o(e.message||"加载失败")}finally{f.value=!1}}}async function Ge(){const l=y();if(l){if(!x.value){o("请选择 Event");return}f.value=!0;try{const e=await b.getDddDetail(l,"event",x.value);n.value.name=e.name||x.value,n.value.topic=e.topic||"",n.value.fields=he(e.fields,[{name:"user_id",type:"uuid",comment:"",enum_values:[]}]),n.value.generateEvent=!0,n.value.generateHandler=!1,n.value.eventForce=!0,S("已加载 Event")}catch(e){o(e.message||"加载失败")}finally{f.value=!1}}}async function ze(){const l=y();if(l){if(!U.value){o("请选择 Handler");return}f.value=!0;try{const e=await b.getDddDetail(l,"event_handler",U.value);n.value.name=e.event_name||U.value,n.value.handlerTopic=e.topic||"",n.value.generateEvent=!1,n.value.generateHandler=!0,n.value.handlerForce=!0,S("已加载 Handler")}catch(e){o(e.message||"加载失败")}finally{f.value=!1}}}async function We(){const l=y();if(l){if(!m.value.name.trim()){o("请输入 Value Object 名称");return}P.value=!0;try{const e=m.value.fields.filter(t=>t.name.trim());R.value=await b.previewValueObject({domain:l,name:m.value.name,fields:e,force:m.value.force})}catch(e){o(e.message)}finally{P.value=!1}}}async function qe(){const l=y();if(l){if(!m.value.name.trim()){o("请输入 Value Object 名称");return}P.value=!0;try{const e=m.value.fields.filter(t=>t.name.trim());R.value=await b.generateValueObject({domain:l,name:m.value.name,fields:e,force:m.value.force}),R.value.success&&S(R.value.message||"Value Object 生成成功")}catch(e){o(e.message)}finally{P.value=!1}}}async function Ke(){const l=y();if(l){if(!p.value.name.trim()){o("请输入 Specification 名称");return}$.value=!0;try{M.value=await b.previewSpecification({domain:l,name:p.value.name,target:p.value.target.trim(),force:p.value.force})}catch(e){o(e.message)}finally{$.value=!1}}}async function Qe(){const l=y();if(l){if(!p.value.name.trim()){o("请输入 Specification 名称");return}$.value=!0;try{M.value=await b.generateSpecification({domain:l,name:p.value.name,target:p.value.target.trim(),force:p.value.force}),M.value.success&&S(M.value.message||"Specification 生成成功")}catch(e){o(e.message)}finally{$.value=!1}}}async function Xe(){const l=y();if(l){if(!g.value.name.trim()){o("请输入 Policy 名称");return}B.value=!0;try{G.value=await b.previewPolicy({domain:l,name:g.value.name,target:g.value.target.trim(),force:g.value.force})}catch(e){o(e.message)}finally{B.value=!1}}}async function Ye(){const l=y();if(l){if(!g.value.name.trim()){o("请输入 Policy 名称");return}B.value=!0;try{G.value=await b.generatePolicy({domain:l,name:g.value.name,target:g.value.target.trim(),force:g.value.force}),G.value.success&&S(G.value.message||"Policy 生成成功")}catch(e){o(e.message)}finally{B.value=!1}}}async function Ze(){const l=y();if(l){if(!n.value.name.trim()){o("请输入 Event 名称");return}if(!n.value.generateEvent&&!n.value.generateHandler){o("请至少选择一个生成项");return}H.value=!0;try{const e=[];if(n.value.generateEvent){const t=n.value.fields.filter(s=>s.name.trim()),i=await b.previewEvent({domain:l,name:n.value.name,fields:t,topic:n.value.topic.trim(),force:n.value.eventForce});e.push(i)}if(n.value.generateHandler){const t=await b.previewEventHandler({domain:l,event_name:n.value.name,topic:(n.value.handlerTopic||n.value.topic).trim(),force:n.value.handlerForce});e.push(t)}N.value=Ve(e)}catch(e){o(e.message)}finally{H.value=!1}}}async function et(){const l=y();if(l){if(!n.value.name.trim()){o("请输入 Event 名称");return}if(!n.value.generateEvent&&!n.value.generateHandler){o("请至少选择一个生成项");return}H.value=!0;try{const e=[];if(n.value.generateEvent){const t=n.value.fields.filter(s=>s.name.trim()),i=await b.generateEvent({domain:l,name:n.value.name,fields:t,topic:n.value.topic.trim(),force:n.value.eventForce});e.push(i)}if(n.value.generateHandler){const t=await b.generateEventHandler({domain:l,event_name:n.value.name,topic:(n.value.handlerTopic||n.value.topic).trim(),force:n.value.handlerForce});e.push(t)}N.value=Ve(e),N.value.success&&S(N.value.message||"Event 生成成功")}catch(e){o(e.message)}finally{H.value=!1}}}return(l,e)=>(r(),u("div",ot,[e[89]||(e[89]=st('<h1 data-v-8f8a44d4>🧩 领域增强 DDD</h1><p class="subtitle" data-v-8f8a44d4>以中文为主，专业术语保留英文：Value Object / Specification / Policy / Event &amp; Handler</p><details class="help-tips" data-v-8f8a44d4><summary data-v-8f8a44d4>📖 使用说明 Usage Guide</summary><div class="tips-content" data-v-8f8a44d4><p data-v-8f8a44d4><strong data-v-8f8a44d4>适用范围：</strong>以下功能依赖已有领域模块，请先在「领域模块」中生成。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Value Object：</strong>领域值对象，用于表达不可变的业务概念。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Specification：</strong>领域规格，用于描述是否满足某个业务条件。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Policy：</strong>领域策略，用于约束或判断业务行为。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>命名建议：</strong>使用 PascalCase，如 <code data-v-8f8a44d4>EmailAddress</code>、<code data-v-8f8a44d4>ActiveUserSpec</code></p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Event 与 Handler：</strong>可单独生成，也可在同一操作中组合生成。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Topic：</strong>留空时自动按领域生成，例如 <code data-v-8f8a44d4>user.activated</code></p><p data-v-8f8a44d4><strong data-v-8f8a44d4>回显与管理：</strong>可从已有列表加载已生成组件，支持重命名与删除。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>Diff 对比：</strong>对比当前文件与预览结果，Handler 对比会包含 module.go / main.go 变更。</p><p data-v-8f8a44d4><strong data-v-8f8a44d4>批量导入：</strong>支持 JSON 或行格式（如 <code data-v-8f8a44d4>name,type,comment</code>），枚举可用 <code data-v-8f8a44d4>enum:a|b</code>。</p></div></details>',3)),a("div",ut,[e[40]||(e[40]=a("label",null,[A(" 选择领域 Domain * "),a("span",{class:"tooltip","data-tooltip":"需要已存在的领域模块"},"ⓘ")],-1)),a("div",rt,[v(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>j.value=t),list:"domain-list",placeholder:"user / order / product"},null,512),[[w,j.value]]),a("datalist",dt,[(r(!0),u(E,null,V(L.value,t=>(r(),u("option",{key:t,value:t},d(t),9,vt))),128))]),v(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>j.value=t),class:"domain-select"},[e[39]||(e[39]=a("option",{value:""},"选择已有领域",-1)),(r(!0),u(E,null,V(L.value,t=>(r(),u("option",{key:t,value:t},d(t),9,ct))),128))],512),[[T,j.value]]),a("button",{class:"btn",onClick:ce,disabled:Z.value},d(Z.value?"刷新中...":"刷新领域"),9,ft)]),a("span",mt,d(De.value),1)]),a("div",pt,[a("section",gt,[e[48]||(e[48]=a("div",{class:"card-header"},[a("h2",null,"值对象 Value Object"),a("span",{class:"tag"},"Domain")],-1)),e[49]||(e[49]=a("p",{class:"card-desc"},"用于建模不可变概念（如金额、邮箱、地址）。",-1)),a("div",bt,[e[42]||(e[42]=a("label",null,"已有 Value Object",-1)),a("div",yt,[v(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>D.value=t),class:"existing-select"},[e[41]||(e[41]=a("option",{value:""},"选择...",-1)),(r(!0),u(E,null,V(I.value?.value_objects||[],t=>(r(),u("option",{key:t.name,value:t.name},d(t.name),9,ht))),128))],512),[[T,D.value]]),a("div",_t,[a("button",{class:"btn",onClick:Ie,disabled:!D.value||f.value}," 加载 ",8,wt),a("button",{class:"btn",onClick:e[3]||(e[3]=t=>X("valueobject",D.value,"Value Object")),disabled:!D.value||f.value}," 重命名 ",8,kt),a("button",{class:"btn danger",onClick:e[4]||(e[4]=t=>Y("valueobject",D.value,"Value Object")),disabled:!D.value||f.value}," 删除 ",8,Et)])])]),a("div",Vt,[e[43]||(e[43]=a("label",null,"名称 Name *",-1)),v(a("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>m.value.name=t),placeholder:"EmailAddress"},null,512),[[w,m.value.name]])]),a("div",St,[a("div",Dt,[e[44]||(e[44]=a("h3",null,"字段 Fields",-1)),a("button",{class:"btn-add",onClick:e[6]||(e[6]=t=>fe(m.value.fields))},"+ 添加字段")]),(r(!0),u(E,null,V(m.value.fields,(t,i)=>(r(),u("div",{class:"field-row",key:i},[v(a("input",{"onUpdate:modelValue":s=>t.name=s,placeholder:"value",class:"field-name"},null,8,Ft),[[w,t.name]]),v(a("select",{"onUpdate:modelValue":s=>t.type=s,class:"field-type"},[(r(!0),u(E,null,V(ue.value,s=>(r(),u("option",{key:s.type,value:s.type},d(s.type)+" - "+d(s.description),9,xt))),128))],8,Ct),[[T,t.type]]),t.type==="enum"?(r(),u("input",{key:0,value:t.enum_values?.join("|"),onInput:s=>pe(t,s.target.value),placeholder:"basic|premium",class:"field-enum"},null,40,Ut)):O("",!0),v(a("input",{"onUpdate:modelValue":s=>t.comment=s,placeholder:"字段备注",class:"field-comment"},null,8,Ot),[[w,t.comment]]),a("button",{class:"btn-remove",onClick:s=>me(m.value.fields,i),disabled:m.value.fields.length===1},"×",8,jt)]))),128))]),a("div",Ht,[a("div",{class:"batch-header"},[e[45]||(e[45]=a("div",{class:"batch-title"},"批量导入/导出字段",-1)),a("div",{class:"batch-actions"},[a("button",{class:"btn",onClick:Fe},"导入"),a("button",{class:"btn",onClick:Ce},"导出")])]),v(a("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>ee.value=t),placeholder:"支持 JSON 数组或行格式：name,type,comment"},null,512),[[w,ee.value]]),e[46]||(e[46]=a("span",{class:"hint"},'示例：{"name":"EmailAddress","fields":[{"name":"value","type":"string","comment":"邮箱"}]}',-1))]),a("label",Pt,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>m.value.force=t)},null,512),[[W,m.value.force]]),e[47]||(e[47]=A(" 强制覆盖 Force ",-1))]),a("div",$t,[a("button",{class:"btn ghost",onClick:Ne,disabled:P.value||_.value},d(_.value?"对比中...":"对比 Diff"),9,Bt),a("button",{class:"btn",onClick:We,disabled:P.value},d(P.value?"预览中...":"预览 Preview"),9,Nt),a("button",{class:"btn primary",onClick:qe,disabled:P.value},d(P.value?"生成中...":"生成 Generate"),9,Tt)]),R.value?(r(),u("div",Jt,[a("div",At,[a("span",null,d(R.value.success?"✅ 生成结果":"❌ 生成失败"),1)]),a("div",Lt,[(r(!0),u(E,null,V(R.value.files,t=>(r(),u("div",{class:"file",key:t.path},[a("span",{class:oe(["file-status",t.status])},d(K(t.status)),3),a("span",It,d(t.path.split("/").pop()),1)]))),128))])])):O("",!0)]),a("section",Rt,[e[57]||(e[57]=a("div",{class:"card-header"},[a("h2",null,"规格 Specification"),a("span",{class:"tag"},"Domain")],-1)),e[58]||(e[58]=a("p",{class:"card-desc"},"用于封装业务规则判断（可复用）。",-1)),a("div",Mt,[e[51]||(e[51]=a("label",null,"已有 Specification",-1)),a("div",Gt,[v(a("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>F.value=t),class:"existing-select"},[e[50]||(e[50]=a("option",{value:""},"选择...",-1)),(r(!0),u(E,null,V(I.value?.specs||[],t=>(r(),u("option",{key:t.name,value:t.name},d(t.name),9,zt))),128))],512),[[T,F.value]]),a("div",Wt,[a("button",{class:"btn",onClick:Re,disabled:!F.value||f.value}," 加载 ",8,qt),a("button",{class:"btn",onClick:e[10]||(e[10]=t=>X("spec",F.value,"Specification")),disabled:!F.value||f.value}," 重命名 ",8,Kt),a("button",{class:"btn danger",onClick:e[11]||(e[11]=t=>Y("spec",F.value,"Specification")),disabled:!F.value||f.value}," 删除 ",8,Qt)])])]),a("div",Xt,[e[52]||(e[52]=a("label",null,"名称 Name *",-1)),v(a("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>p.value.name=t),placeholder:"ActiveUserSpec"},null,512),[[w,p.value.name]])]),a("div",Yt,[e[53]||(e[53]=a("label",null,"目标类型 Target（可选）",-1)),v(a("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>p.value.target=t),placeholder:j.value||"User"},null,8,Zt),[[w,p.value.target]]),e[54]||(e[54]=a("span",{class:"hint"},"留空表示 any",-1))]),a("label",ea,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=t=>p.value.force=t)},null,512),[[W,p.value.force]]),e[55]||(e[55]=A(" 强制覆盖 Force ",-1))]),a("div",ta,[a("div",{class:"batch-header"},[e[56]||(e[56]=a("div",{class:"batch-title"},"批量导入/导出配置",-1)),a("div",{class:"batch-actions"},[a("button",{class:"btn",onClick:xe},"导入"),a("button",{class:"btn",onClick:Ue},"导出")])]),v(a("textarea",{"onUpdate:modelValue":e[15]||(e[15]=t=>te.value=t),placeholder:"JSON 或 Name,Target"},null,512),[[w,te.value]])]),a("div",aa,[a("button",{class:"btn ghost",onClick:Te,disabled:$.value||_.value},d(_.value?"对比中...":"对比 Diff"),9,la),a("button",{class:"btn",onClick:Ke,disabled:$.value},d($.value?"预览中...":"预览 Preview"),9,na),a("button",{class:"btn primary",onClick:Qe,disabled:$.value},d($.value?"生成中...":"生成 Generate"),9,sa)]),M.value?(r(),u("div",ia,[a("div",oa,[a("span",null,d(M.value.success?"✅ 生成结果":"❌ 生成失败"),1)]),a("div",ua,[(r(!0),u(E,null,V(M.value.files,t=>(r(),u("div",{class:"file",key:t.path},[a("span",{class:oe(["file-status",t.status])},d(K(t.status)),3),a("span",ra,d(t.path.split("/").pop()),1)]))),128))])])):O("",!0)]),a("section",da,[e[66]||(e[66]=a("div",{class:"card-header"},[a("h2",null,"策略 Policy"),a("span",{class:"tag"},"Domain")],-1)),e[67]||(e[67]=a("p",{class:"card-desc"},"用于表达业务策略或决策逻辑。",-1)),a("div",va,[e[60]||(e[60]=a("label",null,"已有 Policy",-1)),a("div",ca,[v(a("select",{"onUpdate:modelValue":e[16]||(e[16]=t=>C.value=t),class:"existing-select"},[e[59]||(e[59]=a("option",{value:""},"选择...",-1)),(r(!0),u(E,null,V(I.value?.policies||[],t=>(r(),u("option",{key:t.name,value:t.name},d(t.name),9,fa))),128))],512),[[T,C.value]]),a("div",ma,[a("button",{class:"btn",onClick:Me,disabled:!C.value||f.value}," 加载 ",8,pa),a("button",{class:"btn",onClick:e[17]||(e[17]=t=>X("policy",C.value,"Policy")),disabled:!C.value||f.value}," 重命名 ",8,ga),a("button",{class:"btn danger",onClick:e[18]||(e[18]=t=>Y("policy",C.value,"Policy")),disabled:!C.value||f.value}," 删除 ",8,ba)])])]),a("div",ya,[e[61]||(e[61]=a("label",null,"名称 Name *",-1)),v(a("input",{"onUpdate:modelValue":e[19]||(e[19]=t=>g.value.name=t),placeholder:"PasswordPolicy"},null,512),[[w,g.value.name]])]),a("div",ha,[e[62]||(e[62]=a("label",null,"目标类型 Target（可选）",-1)),v(a("input",{"onUpdate:modelValue":e[20]||(e[20]=t=>g.value.target=t),placeholder:j.value||"User"},null,8,_a),[[w,g.value.target]]),e[63]||(e[63]=a("span",{class:"hint"},"留空表示 any",-1))]),a("label",wa,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[21]||(e[21]=t=>g.value.force=t)},null,512),[[W,g.value.force]]),e[64]||(e[64]=A(" 强制覆盖 Force ",-1))]),a("div",ka,[a("div",{class:"batch-header"},[e[65]||(e[65]=a("div",{class:"batch-title"},"批量导入/导出配置",-1)),a("div",{class:"batch-actions"},[a("button",{class:"btn",onClick:Oe},"导入"),a("button",{class:"btn",onClick:je},"导出")])]),v(a("textarea",{"onUpdate:modelValue":e[22]||(e[22]=t=>ae.value=t),placeholder:"JSON 或 Name,Target"},null,512),[[w,ae.value]])]),a("div",Ea,[a("button",{class:"btn ghost",onClick:Je,disabled:B.value||_.value},d(_.value?"对比中...":"对比 Diff"),9,Va),a("button",{class:"btn",onClick:Xe,disabled:B.value},d(B.value?"预览中...":"预览 Preview"),9,Sa),a("button",{class:"btn primary",onClick:Ye,disabled:B.value},d(B.value?"生成中...":"生成 Generate"),9,Da)]),G.value?(r(),u("div",Fa,[a("div",Ca,[a("span",null,d(G.value.success?"✅ 生成结果":"❌ 生成失败"),1)]),a("div",xa,[(r(!0),u(E,null,V(G.value.files,t=>(r(),u("div",{class:"file",key:t.path},[a("span",{class:oe(["file-status",t.status])},d(K(t.status)),3),a("span",Ua,d(t.path.split("/").pop()),1)]))),128))])])):O("",!0)]),a("section",Oa,[e[84]||(e[84]=a("div",{class:"card-header"},[a("h2",null,"事件与处理器 Event & Handler"),a("span",{class:"tag"},"Domain")],-1)),e[85]||(e[85]=a("p",{class:"card-desc"},"支持事件与处理器组合生成，自动注入模块与 EventBus。",-1)),a("div",ja,[e[69]||(e[69]=a("label",null,"已有 Event",-1)),a("div",Ha,[v(a("select",{"onUpdate:modelValue":e[23]||(e[23]=t=>x.value=t),class:"existing-select"},[e[68]||(e[68]=a("option",{value:""},"选择...",-1)),(r(!0),u(E,null,V(I.value?.events||[],t=>(r(),u("option",{key:t.name,value:t.name},d(t.name),9,Pa))),128))],512),[[T,x.value]]),a("div",$a,[a("button",{class:"btn",onClick:Ge,disabled:!x.value||f.value}," 加载 ",8,Ba),a("button",{class:"btn",onClick:e[24]||(e[24]=t=>X("event",x.value,"Event")),disabled:!x.value||f.value}," 重命名 ",8,Na),a("button",{class:"btn danger",onClick:e[25]||(e[25]=t=>Y("event",x.value,"Event")),disabled:!x.value||f.value}," 删除 ",8,Ta)])])]),a("div",Ja,[e[71]||(e[71]=a("label",null,"已有 Handler",-1)),a("div",Aa,[v(a("select",{"onUpdate:modelValue":e[26]||(e[26]=t=>U.value=t),class:"existing-select"},[e[70]||(e[70]=a("option",{value:""},"选择...",-1)),(r(!0),u(E,null,V(I.value?.event_handlers||[],t=>(r(),u("option",{key:t.name,value:t.name},d(t.name),9,La))),128))],512),[[T,U.value]]),a("div",Ia,[a("button",{class:"btn",onClick:ze,disabled:!U.value||f.value}," 加载 ",8,Ra),a("button",{class:"btn",onClick:e[27]||(e[27]=t=>X("event_handler",U.value,"Handler")),disabled:!U.value||f.value}," 重命名 ",8,Ma),a("button",{class:"btn danger",onClick:e[28]||(e[28]=t=>Y("event_handler",U.value,"Handler")),disabled:!U.value||f.value}," 删除 ",8,Ga)])])]),a("div",za,[e[72]||(e[72]=a("label",null,"事件名称 Event *",-1)),v(a("input",{"onUpdate:modelValue":e[29]||(e[29]=t=>n.value.name=t),placeholder:"UserActivated"},null,512),[[w,n.value.name]])]),a("div",Wa,[e[73]||(e[73]=a("label",null,"事件 Topic（可选）",-1)),v(a("input",{"onUpdate:modelValue":e[30]||(e[30]=t=>n.value.topic=t),placeholder:"user.activated"},null,512),[[w,n.value.topic]]),e[74]||(e[74]=a("span",{class:"hint"},"留空自动生成 topic",-1))]),n.value.generateEvent?(r(),u("div",qa,[a("div",Ka,[e[75]||(e[75]=a("h3",null,"事件字段 Event Fields",-1)),a("button",{class:"btn-add",onClick:e[31]||(e[31]=t=>fe(n.value.fields))},"+ 添加字段")]),(r(!0),u(E,null,V(n.value.fields,(t,i)=>(r(),u("div",{class:"field-row",key:i},[v(a("input",{"onUpdate:modelValue":s=>t.name=s,placeholder:"user_id",class:"field-name"},null,8,Qa),[[w,t.name]]),v(a("select",{"onUpdate:modelValue":s=>t.type=s,class:"field-type"},[(r(!0),u(E,null,V(ue.value,s=>(r(),u("option",{key:s.type,value:s.type},d(s.type)+" - "+d(s.description),9,Ya))),128))],8,Xa),[[T,t.type]]),t.type==="enum"?(r(),u("input",{key:0,value:t.enum_values?.join("|"),onInput:s=>pe(t,s.target.value),placeholder:"created|deleted",class:"field-enum"},null,40,Za)):O("",!0),v(a("input",{"onUpdate:modelValue":s=>t.comment=s,placeholder:"字段备注",class:"field-comment"},null,8,el),[[w,t.comment]]),a("button",{class:"btn-remove",onClick:s=>me(n.value.fields,i),disabled:n.value.fields.length===1},"×",8,tl)]))),128))])):O("",!0),a("div",al,[a("label",ll,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[32]||(e[32]=t=>n.value.generateEvent=t)},null,512),[[W,n.value.generateEvent]]),e[76]||(e[76]=A(" 生成 Event ",-1))]),a("label",nl,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[33]||(e[33]=t=>n.value.generateHandler=t)},null,512),[[W,n.value.generateHandler]]),e[77]||(e[77]=A(" 生成 Handler ",-1))]),a("label",sl,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[34]||(e[34]=t=>n.value.eventForce=t)},null,512),[[W,n.value.eventForce]]),e[78]||(e[78]=A(" Event 强制覆盖 ",-1))]),a("label",il,[v(a("input",{type:"checkbox","onUpdate:modelValue":e[35]||(e[35]=t=>n.value.handlerForce=t)},null,512),[[W,n.value.handlerForce]]),e[79]||(e[79]=A(" Handler 强制覆盖 ",-1))])]),n.value.generateHandler?(r(),u("div",ol,[e[80]||(e[80]=a("label",null,"处理器 Topic（可选）",-1)),v(a("input",{"onUpdate:modelValue":e[36]||(e[36]=t=>n.value.handlerTopic=t),placeholder:"默认使用事件 Topic"},null,512),[[w,n.value.handlerTopic]]),e[81]||(e[81]=a("span",{class:"hint"},"留空时复用事件 Topic",-1))])):O("",!0),a("div",ul,[a("div",{class:"batch-header"},[e[82]||(e[82]=a("div",{class:"batch-title"},"批量导入/导出 Event 配置",-1)),a("div",{class:"batch-actions"},[a("button",{class:"btn",onClick:He},"导入"),a("button",{class:"btn",onClick:Pe},"导出")])]),v(a("textarea",{"onUpdate:modelValue":e[37]||(e[37]=t=>le.value=t),placeholder:"JSON 或行格式：name,type,comment"},null,512),[[w,le.value]]),e[83]||(e[83]=a("span",{class:"hint"},"可携带 topic、handler_topic、generateEvent 等字段",-1))]),a("div",rl,[a("button",{class:"btn ghost",onClick:Ae,disabled:H.value||_.value}," Event 对比 ",8,dl),a("button",{class:"btn ghost",onClick:Le,disabled:H.value||_.value}," Handler 对比 ",8,vl),a("button",{class:"btn",onClick:Ze,disabled:H.value},d(H.value?"预览中...":"预览 Preview"),9,cl),a("button",{class:"btn primary",onClick:et,disabled:H.value},d(H.value?"生成中...":"生成 Generate"),9,fl)]),N.value?(r(),u("div",ml,[a("div",pl,[a("span",null,d(N.value.success?"✅ 生成结果":"❌ 生成失败"),1)]),a("div",gl,[(r(!0),u(E,null,V(N.value.files,t=>(r(),u("div",{class:"file",key:t.path},[a("span",{class:oe(["file-status",t.status])},d(K(t.status)),3),a("span",bl,d(t.path.split("/").pop()),1)]))),128))]),N.value.message?(r(),u("div",yl,d(N.value.message),1)):O("",!0)])):O("",!0)])]),re.value?(r(),u("div",hl,[a("div",{class:"diff-backdrop",onClick:ge}),a("div",_l,[a("div",wl,[a("div",null,[a("div",kl,d(ve.value),1),a("div",El,[J.value?.fileName?(r(),u("span",Vl,"文件："+d(J.value.fileName),1)):O("",!0),J.value?.status?(r(),u("span",Sl,"状态："+d(K(J.value.status)),1)):O("",!0),J.value?.hint?(r(),u("span",Dl,d(J.value.hint),1)):O("",!0)])]),a("button",{class:"btn",onClick:ge},"关闭")]),ne.value.length>1?(r(),u("div",Fl,[e[86]||(e[86]=a("label",null,"切换文件",-1)),v(a("select",{"onUpdate:modelValue":e[38]||(e[38]=t=>se.value=t)},[(r(!0),u(E,null,V(ne.value,(t,i)=>(r(),u("option",{key:t.fileName+i,value:i},d(t.fileName),9,Cl))),128))],512),[[T,se.value]])])):O("",!0),a("div",xl,[a("div",Ul,[e[87]||(e[87]=a("h4",null,"当前文件",-1)),a("pre",null,d(J.value?.existing||"（当前文件不存在）"),1)]),a("div",Ol,[e[88]||(e[88]=a("h4",null,"生成预览",-1)),a("pre",null,d(J.value?.preview||"（暂无预览内容）"),1)])])])])):O("",!0)]))}}),Nl=it(jl,[["__scopeId","data-v-8f8a44d4"]]);export{Nl as default};
