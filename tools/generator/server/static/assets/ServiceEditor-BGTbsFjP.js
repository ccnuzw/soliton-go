import{d as z,r as d,k as A,o as I,u as Q,c as l,a,b as r,n as C,t as n,l as y,v as S,F as V,f as T,j as m,e as H,p as J,i as o}from"./index-CLoSShwM.js";import{a as f,_ as K}from"./_plugin-vue_export-helper-BkqGbvhh.js";import{s as W}from"./toast-BEVcqZGg.js";const X={class:"editor"},Y={class:"tabs"},Z={key:0,class:"services-list"},ee={class:"search-box"},ae={key:0,class:"loading"},te={key:1,class:"empty"},se={key:2,class:"empty"},le={key:3,class:"service-grid"},oe=["onClick"],ie={class:"service-header"},ne={class:"service-title"},de={key:0,class:"service-remark"},re={class:"header-actions"},ve={class:"badge"},ue=["onClick"],ce={class:"service-methods"},me=["title"],pe={key:0,class:"method-remark"},he={key:1},_e={key:0,class:"editing-banner"},ke={class:"layout"},ge={class:"form-panel"},ye={class:"form-group"},fe={class:"form-group"},be={key:0,class:"detection-result"},we={class:"detection-header"},Ce={class:"detection-icon"},Se={class:"detection-content"},xe={class:"detection-message"},Pe={class:"detection-details"},Ve={class:"detail-item"},Te={class:"detail-item"},$e={key:0,class:"detail-item highlight"},Me={class:"methods-section"},Ue=["onUpdate:modelValue"],De=["onUpdate:modelValue"],Le=["onClick","disabled"],Ne={class:"options"},Oe={class:"form-group inline"},Fe={"data-tooltip":"è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶"},Re={key:0,class:"force-warning"},Ge={key:1,class:"error"},Be={class:"actions"},Ee=["disabled"],je=["disabled"],qe={key:0,class:"preview-panel"},ze={class:"preview-header"},Ae={class:"file-list"},Ie={class:"file-path"},Qe={key:0,class:"message"},He=z({__name:"ServiceEditor",setup(Je){const v=d(!1),u=d(null),p=d(""),b=d(!1),w=d([]),_=d("new"),$=d(!1),x=d(null),h=d(""),k=d(null),P=d(!1),M=d(!1),i=d({name:"",remark:"",methods:[{name:"",remark:""}],force:!1}),U=A(()=>{if(!w.value||!h.value.trim())return w.value||[];const s=h.value.toLowerCase();return w.value.filter(e=>e.name.toLowerCase().includes(s)||(e.remark||"").toLowerCase().includes(s)||e.methods.some(t=>t.name.toLowerCase().includes(s)||(t.remark||"").toLowerCase().includes(s)))});I(async()=>{await D()});async function D(){$.value=!0;try{const s=await f.listServices();w.value=s.services}catch(s){console.error("Failed to load services:",s)}finally{$.value=!1}}async function O(s,e){if(e.stopPropagation(),!!confirm(`ç¡®å®šè¦åˆ é™¤åº”ç”¨æœåŠ¡ "${s}" å—ï¼Ÿ

è¿™å°†åˆ é™¤æœåŠ¡æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`))try{await f.deleteService(s),await D()}catch(t){alert(`åˆ é™¤å¤±è´¥: ${t.message}`)}}async function F(){if(!i.value.name||i.value.name.trim()===""){P.value=!1;return}try{const s=await f.detectServiceType(i.value.name);k.value=s,P.value=!0}catch(s){console.error("æ£€æµ‹å¤±è´¥:",s),P.value=!1}}let L=null;Q(()=>i.value.name,()=>{L&&clearTimeout(L),L=setTimeout(F,500)});async function R(s){v.value=!0,p.value="";try{const e=await f.getServiceDetail(s);i.value={name:e.name,remark:e.remark||"",methods:e.methods.map(t=>({name:t.name,remark:t.remark||""})),force:!0},x.value=s,_.value="new"}catch(e){p.value=`åŠ è½½å¤±è´¥: ${e.message}`}finally{v.value=!1}}function G(){i.value.methods.push({name:"",remark:""})}function B(s){i.value.methods.length>1&&i.value.methods.splice(s,1)}async function E(){p.value="",v.value=!0;try{const s=i.value.methods.map(e=>({name:e.name.trim(),remark:e.remark?.trim()})).filter(e=>e.name);u.value=await f.previewService({...i.value,methods:s}),b.value=!0}catch(s){p.value=s.message}finally{v.value=!1}}async function j(){p.value="",v.value=!0;try{const s=i.value.methods.map(e=>({name:e.name.trim(),remark:e.remark?.trim()})).filter(e=>e.name);u.value=await f.generateService({...i.value,methods:s}),b.value=!0,await D(),u.value.success&&W(u.value.message||"ç”ŸæˆæˆåŠŸï¼")}catch(s){p.value=s.message}finally{v.value=!1}}function N(){i.value={name:"",remark:"",methods:[{name:"",remark:""}],force:!1},u.value=null,b.value=!1,x.value=null}function q(s){return{new:"æ–°å»º",overwrite:"è¦†ç›–",skip:"è·³è¿‡",error:"é”™è¯¯"}[s]||s}return(s,e)=>(o(),l("div",X,[e[25]||(e[25]=a("h1",null,"âš™ï¸ ç”Ÿæˆåº”ç”¨æœåŠ¡ Service",-1)),a("div",Y,[a("button",{class:C(["tab",{active:_.value==="new"}]),onClick:e[0]||(e[0]=t=>_.value="new")}," âœ¨ æ–°å»ºæœåŠ¡ ",2),a("button",{class:C(["tab",{active:_.value==="existing"}]),onClick:e[1]||(e[1]=t=>_.value="existing")}," ğŸ“‹ å·²ç”ŸæˆæœåŠ¡ ("+n(w.value?.length||0)+") ",3)]),_.value==="existing"?(o(),l("div",Z,[a("div",ee,[y(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>h.value=t),type:"text",placeholder:"ğŸ” æœç´¢åº”ç”¨æœåŠ¡æˆ–æ–¹æ³•...",class:"search-input"},null,512),[[S,h.value]]),h.value?(o(),l("span",{key:0,class:"search-clear",onClick:e[3]||(e[3]=t=>h.value="")},"âœ•")):r("",!0)]),$.value?(o(),l("div",ae,"åŠ è½½ä¸­...")):U.value.length===0&&!h.value?(o(),l("div",te,[...e[9]||(e[9]=[a("p",null,"æš‚æ— å·²ç”Ÿæˆçš„åº”ç”¨æœåŠ¡",-1),a("p",{class:"hint"},'ç‚¹å‡»"æ–°å»ºæœåŠ¡"å¼€å§‹åˆ›å»º',-1)])])):U.value.length===0&&h.value?(o(),l("div",se,[...e[10]||(e[10]=[a("p",null,"æœªæ‰¾åˆ°åŒ¹é…çš„æœåŠ¡",-1),a("p",{class:"hint"},"å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):(o(),l("div",le,[(o(!0),l(V,null,T(U.value,t=>(o(),l("div",{key:t.name,class:C(["service-card",{"domain-service":t.type==="domain_service","cross-domain-service":t.type==="cross_domain_service"}]),onClick:c=>R(t.name)},[a("div",ie,[a("div",ne,[a("h3",null,n(t.name),1),t.remark?(o(),l("span",de,n(t.remark),1)):r("",!0)]),a("div",re,[a("span",{class:C(["type-badge",t.type])},n(t.type==="domain_service"?"é¢†åŸŸ":"è·¨åŸŸ"),3),a("span",ve,n(t.methods?.length||0)+" æ–¹æ³•",1),a("button",{class:"btn-delete",onClick:c=>O(t.name,c),title:"åˆ é™¤æœåŠ¡"}," ğŸ—‘ï¸ ",8,ue)])]),a("div",ce,[(o(!0),l(V,null,T(t.methods,(c,g)=>(o(),l("span",{key:g,class:"method-tag",title:c.remark||""},[m(n(c.name)+" ",1),c.remark?(o(),l("span",pe,"Â· "+n(c.remark),1)):r("",!0)],8,me))),128))]),e[11]||(e[11]=a("div",{class:"service-action"}," ç‚¹å‡»ç¼–è¾‘ â†’ ",-1))],10,oe))),128))]))])):r("",!0),_.value==="new"?(o(),l("div",he,[x.value?(o(),l("div",_e,[e[12]||(e[12]=m(" âœï¸ æ­£åœ¨ç¼–è¾‘: ",-1)),a("strong",null,n(x.value),1),a("button",{class:"btn-small",onClick:N},"å–æ¶ˆç¼–è¾‘")])):r("",!0),a("div",ke,[a("div",ge,[e[23]||(e[23]=H('<details class="help-tips" data-v-63400433><summary data-v-63400433>ğŸ“– ä½¿ç”¨æŒ‡å— Usage Guide</summary><div class="tips-content" data-v-63400433><div class="tip-section" data-v-63400433><h4 data-v-63400433>ğŸ¯ ä»€ä¹ˆæ˜¯åº”ç”¨æœåŠ¡ (Application Service)?</h4><p data-v-63400433>åº”ç”¨æœåŠ¡æ˜¯ DDD æ¶æ„ä¸­çš„<strong data-v-63400433>åº”ç”¨å±‚ç»„ä»¶</strong>ï¼Œè´Ÿè´£ï¼š</p><ul data-v-63400433><li data-v-63400433>ç¼–æ’å¤šä¸ªé¢†åŸŸæ¨¡å‹ä¹‹é—´çš„ä¸šåŠ¡é€»è¾‘</li><li data-v-63400433>å¤„ç†è·¨é¢†åŸŸçš„å¤æ‚æ“ä½œï¼ˆå¦‚ï¼šæ”¯ä»˜æ—¶æ›´æ–°è®¢å•çŠ¶æ€+æ‰£å‡åº“å­˜+å‘é€é€šçŸ¥ï¼‰</li><li data-v-63400433>ä½œä¸ºé¢†åŸŸå±‚å’Œæ¥å£å±‚ä¹‹é—´çš„æ¡¥æ¢</li></ul></div><div class="tip-section" data-v-63400433><h4 data-v-63400433>ğŸ“ æœåŠ¡åç§°è§„åˆ™</h4><ul data-v-63400433><li data-v-63400433>ä½¿ç”¨ <strong data-v-63400433>PascalCase</strong> æ ¼å¼</li><li data-v-63400433>å»ºè®®ä»¥ <code data-v-63400433>Service</code> ç»“å°¾ï¼ˆä¸å¡«ä¼šè‡ªåŠ¨æ·»åŠ ï¼‰</li><li data-v-63400433>ç¤ºä¾‹ï¼š<code data-v-63400433>PaymentService</code>ã€<code data-v-63400433>OrderProcessService</code>ã€<code data-v-63400433>NotificationService</code></li></ul></div><div class="tip-section" data-v-63400433><h4 data-v-63400433>âš™ï¸ ä¸¤ç§æœåŠ¡ç±»å‹</h4><ul data-v-63400433><li data-v-63400433><span class="type-hint domain" data-v-63400433>é¢†åŸŸæœåŠ¡</span> - ä¸å·²æœ‰é¢†åŸŸåŒåæ—¶ï¼Œç”Ÿæˆåœ¨ <code data-v-63400433>application/{domain}/service.go</code></li><li data-v-63400433><span class="type-hint cross" data-v-63400433>è·¨åŸŸæœåŠ¡</span> - æ— å¯¹åº”é¢†åŸŸæ—¶ï¼Œç”Ÿæˆåœ¨ç‹¬ç«‹ç›®å½• <code data-v-63400433>application/{service}/</code></li></ul></div><div class="tip-section" data-v-63400433><h4 data-v-63400433>ğŸ“‹ æ–¹æ³•å®šä¹‰</h4><ul data-v-63400433><li data-v-63400433>æ¯è¡Œè¾“å…¥ä¸€ä¸ªæ–¹æ³•åï¼Œä½¿ç”¨ PascalCase</li><li data-v-63400433>ç¤ºä¾‹ï¼š<code data-v-63400433>ProcessPayment</code>ã€<code data-v-63400433>RefundOrder</code>ã€<code data-v-63400433>SendNotification</code></li><li data-v-63400433><strong data-v-63400433>ç•™ç©º</strong>å°†è‡ªåŠ¨ç”Ÿæˆï¼šCreateã€Getã€List ä¸‰ä¸ªåŸºç¡€æ–¹æ³•</li></ul></div><div class="tip-section" data-v-63400433><h4 data-v-63400433>ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶</h4><ul data-v-63400433><li data-v-63400433><code data-v-63400433>service.go</code> - æœåŠ¡ä¸»ä½“ï¼ŒåŒ…å«æ–¹æ³•ç­¾åå’Œæ¡©ä»£ç </li><li data-v-63400433><code data-v-63400433>service_dto.go</code> - è¯·æ±‚/å“åº”çš„æ•°æ®ä¼ è¾“å¯¹è±¡</li><li data-v-63400433><code data-v-63400433>module.go</code> - Fx ä¾èµ–æ³¨å…¥æ¨¡å—</li></ul></div><div class="tip-section warning" data-v-63400433><h4 data-v-63400433>âš ï¸ æ³¨æ„äº‹é¡¹</h4><ul data-v-63400433><li data-v-63400433>ç”Ÿæˆåéœ€è¦åœ¨ <code data-v-63400433>service.go</code> ä¸­æ³¨å…¥æ‰€éœ€çš„ Repository</li><li data-v-63400433>æ–¹æ³•ä½“ä¸ºç©ºå®ç°ï¼Œéœ€æ‰‹åŠ¨å¡«å……ä¸šåŠ¡é€»è¾‘</li><li data-v-63400433>ä½¿ç”¨<strong data-v-63400433>å¼ºåˆ¶è¦†ç›–</strong>ä¼šä¸¢å¤±å·²æœ‰ä»£ç ï¼ä»…åœ¨é¦–æ¬¡ç”Ÿæˆæˆ–é‡ç½®æ—¶ä½¿ç”¨</li></ul></div></div></details>',1)),a("div",ye,[e[13]||(e[13]=a("label",null,[m(" æœåŠ¡åç§° Service Name * "),a("span",{class:"tooltip","data-tooltip":"åº”ç”¨æœåŠ¡åç§°ï¼Œç”¨äºè·¨é¢†åŸŸä¸šåŠ¡é€»è¾‘"},"â“˜")],-1)),y(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.name=t),placeholder:"OrderService / PaymentService"},null,512),[[S,i.value.name]]),e[14]||(e[14]=a("span",{class:"hint"},'å¦‚æœæœªåŒ…å« "Service" åç¼€ä¼šè‡ªåŠ¨æ·»åŠ ',-1))]),a("div",fe,[e[15]||(e[15]=a("label",null,"æœåŠ¡å¤‡æ³¨ Remarkï¼ˆå¯é€‰ï¼‰",-1)),y(a("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.remark=t),placeholder:"ç”¨äºè¯´æ˜è¯¥æœåŠ¡ç”¨é€”"},null,512),[[S,i.value.remark]]),e[16]||(e[16]=a("span",{class:"hint"},"ä¼šæ˜¾ç¤ºåœ¨å·²ç”ŸæˆæœåŠ¡å¡ç‰‡ä¸Š",-1))]),P.value&&k.value?(o(),l("div",be,[a("div",we,[a("div",Ce,n(k.value.domain_exists?"âœ…":"â„¹ï¸"),1),a("div",Se,[a("p",xe,n(k.value.message),1),a("div",Pe,[a("span",Ve,[e[17]||(e[17]=a("strong",null,"ç±»å‹:",-1)),m(" "+n(k.value.service_type==="domain_service"?"é¢†åŸŸæœåŠ¡":"è·¨é¢†åŸŸæœåŠ¡"),1)]),a("span",Te,[e[18]||(e[18]=a("strong",null,"ç›®æ ‡:",-1)),m(" "+n(k.value.target_dir),1)]),k.value.should_reuse_dto?(o(),l("span",$e," âœ… å¤ç”¨ç°æœ‰ DTO ")):r("",!0)])]),a("button",{class:"btn-toggle-manual",onClick:e[6]||(e[6]=t=>M.value=!M.value),type:"button"},n(M.value?"ğŸ”„ è‡ªåŠ¨":"âš™ï¸ æ‰‹åŠ¨"),1)])])):r("",!0),a("div",Me,[a("div",{class:"section-header"},[e[19]||(e[19]=a("h3",null,"æ–¹æ³• Methods",-1)),a("button",{class:"btn-add",onClick:G},"+ æ·»åŠ æ–¹æ³•")]),(o(!0),l(V,null,T(i.value.methods,(t,c)=>(o(),l("div",{class:"method-row",key:c},[y(a("input",{"onUpdate:modelValue":g=>t.name=g,placeholder:"CreateOrder / ProcessPayment / CancelOrder",class:"method-name"},null,8,Ue),[[S,t.name]]),y(a("input",{"onUpdate:modelValue":g=>t.remark=g,placeholder:"æ–¹æ³•å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰",class:"method-remark-input"},null,8,De),[[S,t.remark]]),a("button",{class:"btn-remove",onClick:g=>B(c),disabled:i.value.methods.length===1},"Ã—",8,Le)]))),128)),e[20]||(e[20]=a("p",{class:"hint"},"ç•™ç©ºå°†ç”Ÿæˆé»˜è®¤æ–¹æ³•ï¼šCreateã€Getã€List",-1))]),a("div",Ne,[a("div",Oe,[a("label",Fe,[y(a("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>i.value.force=t)},null,512),[[J,i.value.force]]),e[21]||(e[21]=m(" å¼ºåˆ¶è¦†ç›– Force ",-1))]),i.value.force?(o(),l("div",Re,[...e[22]||(e[22]=[m(" âš ï¸ ",-1),a("strong",null,"è­¦å‘Šï¼š",-1),m("å¼ºåˆ¶è¦†ç›–å°†",-1),a("strong",null,"æ°¸ä¹…åˆ é™¤",-1),m("æ‰€æœ‰æ‰‹åŠ¨ä¿®æ”¹çš„ä»£ç ï¼",-1),a("br",null,null,-1),m(" åªåœ¨é¦–æ¬¡ç”Ÿæˆåç«‹å³ä¿®æ”¹æ—¶ä½¿ç”¨ã€‚ä¸€æ—¦å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¯·å‹¿å‹¾é€‰æ­¤é€‰é¡¹ã€‚ ",-1)])])):r("",!0)])]),p.value?(o(),l("div",Ge,n(p.value),1)):r("",!0),a("div",Be,[a("button",{class:"btn",onClick:E,disabled:!i.value.name||v.value},n(v.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview"),9,Ee),a("button",{class:"btn primary",onClick:j,disabled:!i.value.name||v.value},n(v.value?"ç”Ÿæˆä¸­...":"ç”Ÿæˆ Generate"),9,je)])]),b.value&&u.value?(o(),l("div",qe,[a("div",ze,[a("h3",null,n(u.value.success?"âœ… å·²ç”Ÿæˆæ–‡ä»¶":"âŒ é”™è¯¯"),1),a("button",{class:"btn-close",onClick:e[8]||(e[8]=t=>b.value=!1)},"Ã—")]),a("div",Ae,[(o(!0),l(V,null,T(u.value.files,t=>(o(),l("div",{class:"file",key:t.path},[a("span",{class:C(["file-status",t.status])},n(q(t.status)),3),a("span",Ie,n(t.path.split("/").pop()),1)]))),128))]),u.value.message?(o(),l("div",Qe,n(u.value.message),1)):r("",!0),e[24]||(e[24]=a("div",{class:"next-steps"},[a("h4",null,"ä¸‹ä¸€æ­¥ Next Steps:"),a("ol",null,[a("li",null,"åœ¨æœåŠ¡ç»“æ„ä½“ä¸­æ³¨å…¥æ‰€éœ€çš„ Repository"),a("li",null,"åœ¨æ¯ä¸ªæ–¹æ³•ä¸­å®ç°ä¸šåŠ¡é€»è¾‘"),a("li",null,"åœ¨ main.go ä¸­æ³¨å†ŒæœåŠ¡")])],-1)),a("button",{class:"btn primary",onClick:N,style:{width:"100%","margin-top":"16px"}}," ç”Ÿæˆå¦ä¸€ä¸ª ")])):r("",!0)])])):r("",!0)]))}}),Ye=K(He,[["__scopeId","data-v-63400433"]]);export{Ye as default};
