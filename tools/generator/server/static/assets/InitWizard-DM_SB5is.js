import{d as I,r as v,k as S,c as i,a as e,b as g,n as _,e as G,l as h,j as w,v as k,m as $,t as o,F as z,f as E,i as r}from"./index-DydibX5v.js";import{a as D,_ as K}from"./_plugin-vue_export-helper-1WfN36Ns.js";const U={class:"wizard"},W={class:"steps"},B={key:0,class:"step-content"},R={class:"form-group"},J={class:"form-group"},H=["placeholder"],L={class:"hint"},q={class:"form-group"},A={key:0,class:"error"},Q={class:"actions"},X=["disabled"],Y={key:1,class:"step-content"},Z={class:"preview-info"},ee={class:"file-list"},se={class:"file-path"},te={key:0,class:"error"},ae={class:"actions"},oe=["disabled"],le={key:2,class:"step-content"},ne={class:"success-message"},ie={class:"tidy-section"},re={key:0,class:"tidy-progress"},ue={key:1,class:"tidy-success"},de={key:2,class:"tidy-error"},ve={class:"next-steps"},ce={class:"actions",style:{"margin-top":"24px"}},pe=["disabled"],me=I({__name:"InitWizard",setup(fe){const l=v(1),u=v(!1),c=v(null),d=v(""),t=v({name:"",module_name:"",framework_version:"",framework_replace:""}),j=S(()=>t.value.name?`github.com/soliton-go/${t.value.name}`:""),b=S(()=>t.value.module_name||j.value);async function C(){d.value="",u.value=!0;try{c.value=await D.previewInitProject({...t.value,module_name:b.value}),l.value=2}catch(n){d.value=n.message}finally{u.value=!1}}async function M(){d.value="",u.value=!0,p.value=!1,m.value="",f.value="";try{c.value=await D.initProject({...t.value,module_name:b.value}),l.value=3,await x()}catch(n){d.value=n.message}finally{u.value=!1}}const p=v(!1),m=v(""),f=v("");async function x(){p.value=!0,m.value="",f.value="";const n=1500,s=Date.now();try{const P=(c.value?.message||"").match(/at (.+)$/),N=P?P[1]:t.value.name;console.log("Running go mod tidy for:",N);const y=await(await fetch("/api/projects/tidy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_path:N})})).json();console.log("Tidy result:",y);const T=Date.now()-s;T<n&&await new Promise(V=>setTimeout(V,n-T)),y.success?m.value=y.message||"Dependencies downloaded successfully":(f.value=y.error||"Failed to download dependencies",y.output&&(m.value=y.output))}catch(a){console.error("Tidy error:",a),f.value=`Failed to run go mod tidy: ${a.message}`}finally{p.value=!1}}async function F(){u.value=!0;try{const n=`../../${t.value.name}`;if(!(await fetch("/api/projects/switch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n})})).ok)throw new Error("Failed to switch project");window.location.href="/domain"}catch(n){d.value=n.message}finally{u.value=!1}}function O(){l.value=1,c.value=null,t.value={name:"",module_name:"",framework_version:"",framework_replace:""}}return(n,s)=>(r(),i("div",U,[s[19]||(s[19]=e("h1",null,"ğŸš€ åˆå§‹åŒ–æ–°é¡¹ç›® Init Project",-1)),e("div",W,[e("div",{class:_(["step",{active:l.value>=1,done:l.value>1}])},"1. é…ç½® Configure",2),e("div",{class:_(["step",{active:l.value>=2,done:l.value>2}])},"2. é¢„è§ˆ Preview",2),e("div",{class:_(["step",{active:l.value>=3}])},"3. å®Œæˆ Done",2)]),l.value===1?(r(),i("div",B,[s[9]||(s[9]=G('<details class="help-tips" data-v-69b2e27a><summary data-v-69b2e27a>ğŸ’¡ é…ç½®è¯´æ˜ Configuration Help</summary><div class="tips-content" data-v-69b2e27a><p data-v-69b2e27a><strong data-v-69b2e27a>é¡¹ç›®åç§°ï¼š</strong>å°†ä½œä¸ºé¡¹ç›®ç›®å½•åï¼Œå»ºè®®ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦ï¼Œå¦‚ <code data-v-69b2e27a>my-project</code></p><p data-v-69b2e27a><strong data-v-69b2e27a>æ¨¡å—åç§°ï¼š</strong>Go æ¨¡å—çš„å¯¼å…¥è·¯å¾„ï¼Œé€šå¸¸æ ¼å¼ä¸º <code data-v-69b2e27a>github.com/username/project</code></p><p data-v-69b2e27a><strong data-v-69b2e27a>æ¡†æ¶æ›¿æ¢ï¼š</strong>ä»…åœ¨æœ¬åœ°å¼€å‘ Soliton æ¡†æ¶æ—¶ä½¿ç”¨ï¼ŒæŒ‡å‘æ¡†æ¶çš„æœ¬åœ°è·¯å¾„</p></div></details>',1)),e("div",R,[s[4]||(s[4]=e("label",null,[w(" é¡¹ç›®åç§° Project Name * "),e("span",{class:"tooltip","data-tooltip":"é¡¹ç›®ç›®å½•åç§°ï¼Œå°†åˆ›å»ºæ­¤åç§°çš„æ–‡ä»¶å¤¹"},"â“˜")],-1)),h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.name=a),placeholder:"my-awesome-project",onKeyup:$(C,["enter"])},null,544),[[k,t.value.name]]),s[5]||(s[5]=e("span",{class:"hint"},"æ–°é¡¹ç›®çš„ç›®å½•åç§°",-1))]),e("div",J,[s[6]||(s[6]=e("label",null,[w(" æ¨¡å—åç§° Module Name "),e("span",{class:"tooltip","data-tooltip":"Go æ¨¡å—è·¯å¾„ï¼Œç”¨äº import è¯­å¥"},"â“˜")],-1)),h(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.module_name=a),placeholder:j.value||"github.com/yourname/my-project"},null,8,H),[[k,t.value.module_name]]),e("span",L,"Go æ¨¡å—è·¯å¾„ï¼ˆé»˜è®¤ï¼šgithub.com/soliton-go/"+o(t.value.name||"project")+"ï¼‰",1)]),e("div",q,[s[7]||(s[7]=e("label",null,[w(" æ¡†æ¶æ›¿æ¢è·¯å¾„ Framework Replaceï¼ˆå¯é€‰ï¼‰ "),e("span",{class:"tooltip","data-tooltip":"æœ¬åœ°å¼€å‘æ—¶ä½¿ç”¨ï¼ŒæŒ‡å‘ soliton-go/framework çš„è·¯å¾„"},"â“˜")],-1)),h(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.framework_replace=a),placeholder:"../framework æˆ– /path/to/framework"},null,512),[[k,t.value.framework_replace]]),s[8]||(s[8]=e("span",{class:"hint"},"ç”¨äºå¼€å‘çš„ soliton-go/framework æœ¬åœ°è·¯å¾„",-1))]),d.value?(r(),i("div",A,o(d.value),1)):g("",!0),e("div",Q,[e("button",{class:"btn primary",disabled:!t.value.name||u.value,onClick:C},o(u.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview â†’"),9,X)])])):g("",!0),l.value===2?(r(),i("div",Y,[e("div",Z,[s[10]||(s[10]=e("strong",null,"é¡¹ç›® Project:",-1)),w(" "+o(t.value.name),1),s[11]||(s[11]=e("br",null,null,-1)),s[12]||(s[12]=e("strong",null,"æ¨¡å— Module:",-1)),w(" "+o(b.value),1)]),e("div",ee,[s[13]||(s[13]=e("h3",null,"å°†è¦åˆ›å»ºçš„æ–‡ä»¶ Files to Create:",-1)),(r(!0),i(z,null,E(c.value?.files,a=>(r(),i("div",{class:"file",key:a.path},[e("span",{class:_(["file-status",a.status])},o(a.status==="new"?"NEW":a.status==="skip"?"SKIP":a.status),3),e("span",se,o(a.path),1)]))),128))]),d.value?(r(),i("div",te,o(d.value),1)):g("",!0),e("div",ae,[e("button",{class:"btn",onClick:s[3]||(s[3]=a=>l.value=1)},"â† è¿”å›"),e("button",{class:"btn primary",disabled:u.value,onClick:M},o(u.value?"åˆ›å»ºä¸­...":"åˆ›å»ºé¡¹ç›® Create"),9,oe)])])):g("",!0),l.value===3?(r(),i("div",le,[s[17]||(s[17]=e("div",{class:"success-icon"},"âœ…",-1)),s[18]||(s[18]=e("h2",null,"é¡¹ç›®åˆ›å»ºæˆåŠŸï¼Project Created Successfully!",-1)),e("p",ne,o(c.value?.message),1),e("div",ie,[s[15]||(s[15]=e("h3",null,"ğŸ“¦ ä¸‹è½½ä¾èµ– Downloading Dependencies",-1)),p.value?(r(),i("div",re,[...s[14]||(s[14]=[e("div",{class:"spinner"},null,-1),e("span",null,"æ­£åœ¨è¿è¡Œ go mod tidy...",-1)])])):m.value?(r(),i("div",ue," âœ… "+o(m.value),1)):f.value?(r(),i("div",de," âŒ "+o(f.value),1)):g("",!0)]),e("div",ve,[s[16]||(s[16]=e("h3",null,"ä¸‹ä¸€æ­¥ Next Steps:",-1)),e("pre",null,"cd "+o(t.value.name)+`
soliton-gen domain User --fields "username,email" --wire
GOWORK=off go run ./cmd/main.go`,1)]),e("div",ce,[e("button",{class:"btn",onClick:O},"åˆ›å»ºå¦ä¸€ä¸ªé¡¹ç›®"),e("button",{class:"btn primary",disabled:p.value,onClick:F},o(p.value?"è¯·ç­‰å¾…ä¾èµ–ä¸‹è½½å®Œæˆ...":"åˆ‡æ¢åˆ°æ–°é¡¹ç›®å¹¶ç”Ÿæˆé¢†åŸŸ â†’"),9,pe)])])):g("",!0)]))}}),_e=K(me,[["__scopeId","data-v-69b2e27a"]]);export{_e as default};
