import{d as J,r,k as K,o as W,c as n,a as t,b as f,n as B,t as u,l as p,v as V,F as g,f as U,j as v,e as X,p as E,q as Y,s as Z,i as o}from"./index-C10qHKxE.js";import{a as k,_ as ee}from"./_plugin-vue_export-helper-1WfN36Ns.js";import{s as T,a as te}from"./toast-DBA6zo1F.js";const le={class:"editor"},se={class:"tabs"},ae={key:0,class:"domains-list"},ne={class:"search-box"},oe={key:0,class:"loading"},ie={key:1,class:"empty"},de={key:2,class:"empty"},ue={key:3,class:"domain-grid"},re=["onClick"],ve={class:"domain-header"},ce={class:"header-actions"},me={class:"badge"},fe=["onClick"],pe={class:"domain-fields"},be={key:1},_e={key:0,class:"editing-banner"},ye={class:"layout"},ge={class:"form-panel"},ke={class:"form-group"},we={class:"fields-section"},he=["onUpdate:modelValue"],Ce=["onUpdate:modelValue"],De=["value"],Ve=["value","onInput"],Ue={class:"field-actions"},Fe=["onClick","disabled"],$e=["onClick","disabled"],Ne=["onClick","disabled"],Se={class:"options"},Be={class:"form-group inline"},Ee={"data-tooltip":"å¯ç”¨åå°†æ·»åŠ  DeletedAt å­—æ®µï¼Œåˆ é™¤æ—¶æ ‡è®°è€ŒéçœŸåˆ é™¤"},Me={class:"form-group inline"},Pe={"data-tooltip":"è‡ªåŠ¨åœ¨ main.go ä¸­æ³¨å†Œæ­¤æ¨¡å—"},Te={class:"form-group inline"},qe={"data-tooltip":"è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶"},xe={key:0,class:"force-warning"},Ge={class:"advanced"},Le={class:"form-group"},Ie={class:"form-group"},je={key:0,class:"error"},Ae={class:"actions"},Oe=["disabled"],ze=["disabled"],Qe={key:0,class:"preview-panel"},Re={class:"preview-header"},He={class:"file-list"},Je={class:"file-path"},Ke={key:0,class:"message"},We={class:"modal-message"},Xe={class:"modal-actions"},Ye=J({__name:"DomainEditor",setup(Ze){const c=r(!1),m=r(null),b=r(""),w=r(!1),M=r([]),h=r([]),y=r("new"),$=r(!1),F=r(null),_=r(""),C=r(!1),D=r(null),a=r({name:"",fields:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!0,force:!1}),N=K(()=>{if(!h.value||!_.value.trim())return h.value||[];const l=_.value.toLowerCase();return h.value.filter(e=>e.name.toLowerCase().includes(l)||e.fields.some(s=>s.toLowerCase().includes(l)))});W(async()=>{try{const l=await k.getFieldTypes();M.value=l.types,await S()}catch(l){console.error(l)}});async function S(){$.value=!0;try{const l=await k.listDomains();h.value=l.domains}catch(l){console.error("Failed to load domains:",l)}finally{$.value=!1}}async function q(l,e){e.stopPropagation(),D.value=l,C.value=!0}async function x(){if(!D.value)return;const l=D.value;C.value=!1;try{await k.deleteDomain(l),await S(),T(`é¢†åŸŸæ¨¡å— "${l}" åˆ é™¤æˆåŠŸ`)}catch(e){te(`åˆ é™¤å¤±è´¥: ${e.message}`)}finally{D.value=null}}async function G(l){c.value=!0,b.value="";try{const e=await k.getDomainDetail(l),s=e.fields.map(d=>{let i=L(d.type);return{name:d.snake_name,type:i,enum_values:d.is_enum?[]:void 0}});a.value={name:e.name,fields:s.length>0?s:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!1,force:!0},F.value=l,y.value="new"}catch(e){b.value=`åŠ è½½å¤±è´¥: ${e.message}`}finally{c.value=!1}}function L(l){return l=l.replace("*",""),l==="string"?"string":l==="int"?"int":l==="int64"?"int64":l==="float64"?"float64":l==="bool"?"bool":l==="time.Time"?"time":l.includes("Time")?"time?":"enum"}function I(){a.value.fields.push({name:"",type:"string",enum_values:[]})}function j(l){a.value.fields.length>1&&a.value.fields.splice(l,1)}function A(l){if(l>0){const e=a.value.fields;[e[l-1],e[l]]=[e[l],e[l-1]]}}function O(l){const e=a.value.fields;l<e.length-1&&([e[l],e[l+1]]=[e[l+1],e[l]])}function z(l,e){l.enum_values=e.split("|").map(s=>s.trim()).filter(Boolean)}async function Q(){b.value="",c.value=!0;try{const l=a.value.fields.filter(e=>e.name.trim());m.value=await k.previewDomain({...a.value,fields:l}),w.value=!0}catch(l){b.value=l.message}finally{c.value=!1}}async function R(){b.value="",c.value=!0;try{const l=a.value.fields.filter(e=>e.name&&e.type);m.value=await k.generateDomain({...a.value,fields:l}),w.value=!0,await S(),m.value.success&&T(m.value.message||"ç”ŸæˆæˆåŠŸï¼")}catch(l){b.value=l.message}finally{c.value=!1}}function P(){a.value={name:"",fields:[{name:"",type:"string",enum_values:[]}],table_name:"",route_base:"",soft_delete:!1,wire:!0,force:!1},m.value=null,w.value=!1,F.value=null}function H(l){return{new:"æ–°å»º",overwrite:"è¦†ç›–",skip:"è·³è¿‡",error:"é”™è¯¯"}[l]||l}return(l,e)=>(o(),n(g,null,[t("div",le,[e[28]||(e[28]=t("h1",null,"ğŸ“¦ ç”Ÿæˆé¢†åŸŸæ¨¡å— Domain",-1)),t("div",se,[t("button",{class:B(["tab",{active:y.value==="new"}]),onClick:e[0]||(e[0]=s=>y.value="new")}," âœ¨ æ–°å»ºæ¨¡å— ",2),t("button",{class:B(["tab",{active:y.value==="existing"}]),onClick:e[1]||(e[1]=s=>y.value="existing")}," ğŸ“‹ å·²ç”Ÿæˆæ¨¡å— ("+u(h.value?.length||0)+") ",3)]),y.value==="existing"?(o(),n("div",ae,[t("div",ne,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),type:"text",placeholder:"ğŸ” æœç´¢é¢†åŸŸæ¨¡å—æˆ–å­—æ®µ...",class:"search-input"},null,512),[[V,_.value]]),_.value?(o(),n("span",{key:0,class:"search-clear",onClick:e[3]||(e[3]=s=>_.value="")},"âœ•")):f("",!0)]),$.value?(o(),n("div",oe,"åŠ è½½ä¸­...")):N.value.length===0&&!_.value?(o(),n("div",ie,[...e[14]||(e[14]=[t("p",null,"æš‚æ— å·²ç”Ÿæˆçš„é¢†åŸŸæ¨¡å—",-1),t("p",{class:"hint"},'ç‚¹å‡»"æ–°å»ºæ¨¡å—"å¼€å§‹åˆ›å»º',-1)])])):N.value.length===0&&_.value?(o(),n("div",de,[...e[15]||(e[15]=[t("p",null,"æœªæ‰¾åˆ°åŒ¹é…çš„æ¨¡å—",-1),t("p",{class:"hint"},"å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):(o(),n("div",ue,[(o(!0),n(g,null,U(N.value,s=>(o(),n("div",{key:s.name,class:"domain-card",onClick:d=>G(s.name)},[t("div",ve,[t("h3",null,u(s.name),1),t("div",ce,[t("span",me,u(s.fields?.length||0)+" å­—æ®µ",1),t("button",{class:"btn-delete",onClick:d=>q(s.name,d),title:"åˆ é™¤æ¨¡å—"}," ğŸ—‘ï¸ ",8,fe)])]),t("div",pe,[(o(!0),n(g,null,U(s.fields,(d,i)=>(o(),n("span",{key:i,class:"field-tag"},u(d),1))),128))]),e[16]||(e[16]=t("div",{class:"domain-action"}," ç‚¹å‡»ç¼–è¾‘ â†’ ",-1))],8,re))),128))]))])):f("",!0),y.value==="new"?(o(),n("div",be,[F.value?(o(),n("div",_e,[e[17]||(e[17]=v(" âœï¸ æ­£åœ¨ç¼–è¾‘: ",-1)),t("strong",null,u(F.value),1),t("button",{class:"btn-small",onClick:P},"å–æ¶ˆç¼–è¾‘")])):f("",!0),t("div",ye,[t("div",ge,[e[27]||(e[27]=X('<details class="help-tips" data-v-964df4c7><summary data-v-964df4c7>ğŸ“– ä½¿ç”¨æŒ‡å— Usage Guide</summary><div class="tips-content" data-v-964df4c7><p data-v-964df4c7><strong data-v-964df4c7>é¢†åŸŸåç§°ï¼š</strong>ä½¿ç”¨ PascalCase æ ¼å¼ï¼Œå¦‚ <code data-v-964df4c7>User</code>ã€<code data-v-964df4c7>Order</code></p><p data-v-964df4c7><strong data-v-964df4c7>å­—æ®µç±»å‹ï¼š</strong></p><ul data-v-964df4c7><li data-v-964df4c7><code data-v-964df4c7>string</code> - å­—ç¬¦ä¸² (varchar 255)</li><li data-v-964df4c7><code data-v-964df4c7>text</code> - é•¿æ–‡æœ¬</li><li data-v-964df4c7><code data-v-964df4c7>int</code> / <code data-v-964df4c7>int64</code> - æ•´æ•°</li><li data-v-964df4c7><code data-v-964df4c7>time</code> - æ—¶é—´æˆ³ï¼Œ<code data-v-964df4c7>time?</code> - å¯é€‰æ—¶é—´</li><li data-v-964df4c7><code data-v-964df4c7>enum</code> - æšä¸¾ç±»å‹ï¼Œéœ€å¡«å†™æšä¸¾å€¼ï¼ˆç”¨ | åˆ†éš”ï¼‰</li></ul><p data-v-964df4c7><strong data-v-964df4c7>æç¤ºï¼š</strong>å‹¾é€‰&quot;è‡ªåŠ¨æ³¨å…¥åˆ° main.go&quot;å¯è‡ªåŠ¨å®Œæˆæ¨¡å—æ³¨å†Œï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ä»£ç </p></div></details>',1)),t("div",ke,[e[18]||(e[18]=t("label",null,[v(" é¢†åŸŸåç§° Domain Name * "),t("span",{class:"tooltip","data-tooltip":"å®ä½“åç§°ï¼Œå°†ç”Ÿæˆå¯¹åº”çš„ Go ç»“æ„ä½“"},"â“˜")],-1)),p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.name=s),placeholder:"User / Order / Product"},null,512),[[V,a.value.name]])]),t("div",we,[t("div",{class:"section-header"},[e[19]||(e[19]=t("h3",null,"å­—æ®µ Fields",-1)),t("button",{class:"btn-add",onClick:I},"+ æ·»åŠ å­—æ®µ")]),(o(!0),n(g,null,U(a.value.fields,(s,d)=>(o(),n("div",{class:"field-row",key:d},[p(t("input",{"onUpdate:modelValue":i=>s.name=i,placeholder:"username / email / status",class:"field-name"},null,8,he),[[V,s.name]]),p(t("select",{"onUpdate:modelValue":i=>s.type=i,class:"field-type"},[(o(!0),n(g,null,U(M.value,i=>(o(),n("option",{key:i.type,value:i.type},u(i.type)+" - "+u(i.description),9,De))),128))],8,Ce),[[Z,s.type]]),s.type==="enum"?(o(),n("input",{key:0,value:s.enum_values?.join("|"),onInput:i=>z(s,i.target.value),placeholder:"active|inactive|banned",class:"field-enum","data-tooltip":"æšä¸¾å€¼ç”¨ | åˆ†éš”ï¼Œå¦‚ï¼šactive|inactive"},null,40,Ve)):f("",!0),t("div",Ue,[t("button",{class:"btn-move",onClick:i=>A(d),disabled:d===0,title:"ä¸Šç§»"},"â†‘",8,Fe),t("button",{class:"btn-move",onClick:i=>O(d),disabled:d===a.value.fields.length-1,title:"ä¸‹ç§»"},"â†“",8,$e),t("button",{class:"btn-remove",onClick:i=>j(d),disabled:a.value.fields.length===1},"Ã—",8,Ne)])]))),128))]),t("div",Se,[t("div",Be,[t("label",Ee,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>a.value.soft_delete=s)},null,512),[[E,a.value.soft_delete]]),e[20]||(e[20]=v(" å¯ç”¨è½¯åˆ é™¤ Soft Delete ",-1))])]),t("div",Me,[t("label",Pe,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>a.value.wire=s)},null,512),[[E,a.value.wire]]),e[21]||(e[21]=v(" è‡ªåŠ¨æ³¨å…¥åˆ° main.go ",-1))])]),t("div",Te,[t("label",qe,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>a.value.force=s)},null,512),[[E,a.value.force]]),e[22]||(e[22]=v(" å¼ºåˆ¶è¦†ç›– Force ",-1))]),a.value.force?(o(),n("div",xe,[...e[23]||(e[23]=[v(" âš ï¸ ",-1),t("strong",null,"è­¦å‘Šï¼š",-1),v("å¼ºåˆ¶è¦†ç›–å°†",-1),t("strong",null,"æ°¸ä¹…åˆ é™¤",-1),v("æ‰€æœ‰æ‰‹åŠ¨ä¿®æ”¹çš„ä»£ç ï¼",-1),t("br",null,null,-1),v(" åªåœ¨é¦–æ¬¡ç”Ÿæˆåç«‹å³ä¿®æ”¹å­—æ®µæ—¶ä½¿ç”¨ã€‚ä¸€æ—¦å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¯·å‹¿å‹¾é€‰æ­¤é€‰é¡¹ã€‚ ",-1)])])):f("",!0)])]),t("details",Ge,[e[26]||(e[26]=t("summary",null,"é«˜çº§é€‰é¡¹ Advanced",-1)),t("div",Le,[e[24]||(e[24]=t("label",null,"è‡ªå®šä¹‰è¡¨å Table Name",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.table_name=s),placeholder:"ï¼ˆè‡ªåŠ¨ï¼šåç§°çš„å¤æ•°å½¢å¼ï¼‰"},null,512),[[V,a.value.table_name]])]),t("div",Ie,[e[25]||(e[25]=t("label",null,"è‡ªå®šä¹‰è·¯ç”±å‰ç¼€ Route Base",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.route_base=s),placeholder:"ï¼ˆè‡ªåŠ¨ï¼šåç§°çš„å¤æ•°å½¢å¼ï¼‰"},null,512),[[V,a.value.route_base]])])]),b.value?(o(),n("div",je,u(b.value),1)):f("",!0),t("div",Ae,[t("button",{class:"btn",onClick:Q,disabled:!a.value.name||c.value},u(c.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview"),9,Oe),t("button",{class:"btn primary",onClick:R,disabled:!a.value.name||c.value},u(c.value?"ç”Ÿæˆä¸­...":"ç”Ÿæˆ Generate"),9,ze)])]),w.value&&m.value?(o(),n("div",Qe,[t("div",Re,[t("h3",null,u(m.value.success?"âœ… å·²ç”Ÿæˆæ–‡ä»¶":"âŒ é”™è¯¯"),1),t("button",{class:"btn-close",onClick:e[10]||(e[10]=s=>w.value=!1)},"Ã—")]),t("div",He,[(o(!0),n(g,null,U(m.value.files,s=>(o(),n("div",{class:"file",key:s.path},[t("span",{class:B(["file-status",s.status])},u(H(s.status)),3),t("span",Je,u(s.path.split("/").pop()),1)]))),128))]),m.value.message?(o(),n("div",Ke,u(m.value.message),1)):f("",!0),t("button",{class:"btn primary",onClick:P,style:{width:"100%","margin-top":"16px"}}," ç”Ÿæˆå¦ä¸€ä¸ª ")])):f("",!0)])])):f("",!0)]),C.value?(o(),n("div",{key:0,class:"modal-overlay",onClick:e[13]||(e[13]=s=>C.value=!1)},[t("div",{class:"modal-dialog",onClick:e[12]||(e[12]=Y(()=>{},["stop"]))},[e[31]||(e[31]=t("div",{class:"modal-icon"},"âš ï¸",-1)),e[32]||(e[32]=t("h3",null,"ç¡®è®¤åˆ é™¤",-1)),t("p",We,[e[29]||(e[29]=v(" ç¡®å®šè¦åˆ é™¤é¢†åŸŸæ¨¡å— ",-1)),t("strong",null,'"'+u(D.value)+'"',1),e[30]||(e[30]=v(" å—ï¼Ÿ ",-1))]),e[33]||(e[33]=t("p",{class:"modal-warning"}," è¿™å°†åˆ é™¤æ•´ä¸ªç›®å½•åŠå…¶æ‰€æœ‰æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼ ",-1)),t("div",Xe,[t("button",{class:"btn",onClick:e[11]||(e[11]=s=>C.value=!1)},"å–æ¶ˆ"),t("button",{class:"btn danger",onClick:x},"ç¡®è®¤åˆ é™¤")])])])):f("",!0)],64))}}),st=ee(Ye,[["__scopeId","data-v-964df4c7"]]);export{st as default};
