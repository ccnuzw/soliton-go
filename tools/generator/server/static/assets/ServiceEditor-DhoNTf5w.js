import{d as z,r as d,k as I,o as Q,u as A,c as o,a as e,b as c,n as k,t as i,l as x,v as U,F as P,f as T,j as m,e as H,p as J,i as n}from"./index-BUh8ZwUH.js";import{a as f,_ as K}from"./_plugin-vue_export-helper-1WfN36Ns.js";import{s as W}from"./toast-B4Yq8xk6.js";const X={class:"editor"},Y={class:"tabs"},Z={key:0,class:"services-list"},ee={class:"search-box"},te={key:0,class:"loading"},se={key:1,class:"empty"},ae={key:2,class:"empty"},le={key:3,class:"service-grid"},oe=["onClick"],ne={class:"service-header"},ie={class:"header-actions"},de={class:"badge"},ue=["onClick"],re={class:"service-methods"},ce={key:1},ve={key:0,class:"editing-banner"},me={class:"layout"},pe={class:"form-panel"},he={class:"form-group"},_e={key:0,class:"detection-result"},ye={class:"detection-header"},fe={class:"detection-icon"},ge={class:"detection-content"},be={class:"detection-message"},ke={class:"detection-details"},we={class:"detail-item"},Ce={class:"detail-item"},Se={key:0,class:"detail-item highlight"},xe={class:"methods-section"},Pe=["onUpdate:modelValue"],Te=["onClick","disabled"],$e={class:"options"},Me={class:"form-group inline"},Ve={"data-tooltip":"è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶"},Le={key:0,class:"force-warning"},Oe={key:1,class:"error"},Ue={class:"actions"},De=["disabled"],Fe=["disabled"],Ge={key:0,class:"preview-panel"},Ne={class:"preview-header"},qe={class:"file-list"},Be={class:"file-path"},Ee={key:0,class:"message"},Re=z({__name:"ServiceEditor",setup(je){const u=d(!1),r=d(null),p=d(""),g=d(!1),b=d([]),_=d("new"),$=d(!1),w=d(null),h=d(""),y=d(null),C=d(!1),M=d(!1),l=d({name:"",methods:[""],force:!1}),V=I(()=>{if(!b.value||!h.value.trim())return b.value||[];const a=h.value.toLowerCase();return b.value.filter(t=>t.name.toLowerCase().includes(a)||t.methods.some(s=>s.toLowerCase().includes(a)))});Q(async()=>{await L()});async function L(){$.value=!0;try{const a=await f.listServices();b.value=a.services}catch(a){console.error("Failed to load services:",a)}finally{$.value=!1}}async function F(a,t){if(t.stopPropagation(),!!confirm(`ç¡®å®šè¦åˆ é™¤åº”ç”¨æœåŠ¡ "${a}" å—ï¼Ÿ

è¿™å°†åˆ é™¤æœåŠ¡æ–‡ä»¶ï¼Œæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`))try{await f.deleteService(a),await L()}catch(s){alert(`åˆ é™¤å¤±è´¥: ${s.message}`)}}async function G(){if(!l.value.name||l.value.name.trim()===""){C.value=!1;return}try{const a=await f.detectServiceType(l.value.name);y.value=a,C.value=!0}catch(a){console.error("æ£€æµ‹å¤±è´¥:",a),C.value=!1}}let O=null;A(()=>l.value.name,()=>{O&&clearTimeout(O),O=setTimeout(G,500)});async function N(a){u.value=!0,p.value="";try{const t=await f.getServiceDetail(a);l.value={name:t.name,methods:t.methods.map(s=>s.name),force:!0},w.value=a,_.value="new"}catch(t){p.value=`åŠ è½½å¤±è´¥: ${t.message}`}finally{u.value=!1}}function q(){l.value.methods.push("")}function B(a){l.value.methods.length>1&&l.value.methods.splice(a,1)}async function E(){p.value="",u.value=!0;try{const a=l.value.methods.filter(t=>t.trim());r.value=await f.previewService({...l.value,methods:a}),g.value=!0}catch(a){p.value=a.message}finally{u.value=!1}}async function R(){p.value="",u.value=!0;try{const a=l.value.methods.filter(t=>t.trim());r.value=await f.generateService({...l.value,methods:a}),g.value=!0,await L(),r.value.success&&W(r.value.message||"ç”ŸæˆæˆåŠŸï¼")}catch(a){p.value=a.message}finally{u.value=!1}}function D(){l.value={name:"",methods:[""],force:!1},r.value=null,g.value=!1,w.value=null}function j(a){return{new:"æ–°å»º",overwrite:"è¦†ç›–",skip:"è·³è¿‡",error:"é”™è¯¯"}[a]||a}return(a,t)=>(n(),o("div",X,[t[22]||(t[22]=e("h1",null,"âš™ï¸ ç”Ÿæˆåº”ç”¨æœåŠ¡ Service",-1)),e("div",Y,[e("button",{class:k(["tab",{active:_.value==="new"}]),onClick:t[0]||(t[0]=s=>_.value="new")}," âœ¨ æ–°å»ºæœåŠ¡ ",2),e("button",{class:k(["tab",{active:_.value==="existing"}]),onClick:t[1]||(t[1]=s=>_.value="existing")}," ğŸ“‹ å·²ç”ŸæˆæœåŠ¡ ("+i(b.value?.length||0)+") ",3)]),_.value==="existing"?(n(),o("div",Z,[e("div",ee,[x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s),type:"text",placeholder:"ğŸ” æœç´¢åº”ç”¨æœåŠ¡æˆ–æ–¹æ³•...",class:"search-input"},null,512),[[U,h.value]]),h.value?(n(),o("span",{key:0,class:"search-clear",onClick:t[3]||(t[3]=s=>h.value="")},"âœ•")):c("",!0)]),$.value?(n(),o("div",te,"åŠ è½½ä¸­...")):V.value.length===0&&!h.value?(n(),o("div",se,[...t[8]||(t[8]=[e("p",null,"æš‚æ— å·²ç”Ÿæˆçš„åº”ç”¨æœåŠ¡",-1),e("p",{class:"hint"},'ç‚¹å‡»"æ–°å»ºæœåŠ¡"å¼€å§‹åˆ›å»º',-1)])])):V.value.length===0&&h.value?(n(),o("div",ae,[...t[9]||(t[9]=[e("p",null,"æœªæ‰¾åˆ°åŒ¹é…çš„æœåŠ¡",-1),e("p",{class:"hint"},"å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):(n(),o("div",le,[(n(!0),o(P,null,T(V.value,s=>(n(),o("div",{key:s.name,class:k(["service-card",{"domain-service":s.type==="domain_service","cross-domain-service":s.type==="cross_domain_service"}]),onClick:v=>N(s.name)},[e("div",ne,[e("h3",null,i(s.name),1),e("div",ie,[e("span",{class:k(["type-badge",s.type])},i(s.type==="domain_service"?"é¢†åŸŸ":"è·¨åŸŸ"),3),e("span",de,i(s.methods?.length||0)+" æ–¹æ³•",1),e("button",{class:"btn-delete",onClick:v=>F(s.name,v),title:"åˆ é™¤æœåŠ¡"}," ğŸ—‘ï¸ ",8,ue)])]),e("div",re,[(n(!0),o(P,null,T(s.methods,(v,S)=>(n(),o("span",{key:S,class:"method-tag"},i(v),1))),128))]),t[10]||(t[10]=e("div",{class:"service-action"}," ç‚¹å‡»ç¼–è¾‘ â†’ ",-1))],10,oe))),128))]))])):c("",!0),_.value==="new"?(n(),o("div",ce,[w.value?(n(),o("div",ve,[t[11]||(t[11]=m(" âœï¸ æ­£åœ¨ç¼–è¾‘: ",-1)),e("strong",null,i(w.value),1),e("button",{class:"btn-small",onClick:D},"å–æ¶ˆç¼–è¾‘")])):c("",!0),e("div",me,[e("div",pe,[t[20]||(t[20]=H('<details class="help-tips" data-v-8897a6ca><summary data-v-8897a6ca>ğŸ“– ä½¿ç”¨æŒ‡å— Usage Guide</summary><div class="tips-content" data-v-8897a6ca><p data-v-8897a6ca><strong data-v-8897a6ca>æœåŠ¡åç§°ï¼š</strong>ä½¿ç”¨ PascalCase æ ¼å¼ï¼Œå¦‚ <code data-v-8897a6ca>OrderService</code>ã€<code data-v-8897a6ca>PaymentService</code></p><p data-v-8897a6ca><strong data-v-8897a6ca>æ–¹æ³•å®šä¹‰ï¼š</strong>æ¯è¡Œä¸€ä¸ªæ–¹æ³•åï¼Œå¦‚ <code data-v-8897a6ca>CreateOrder</code>ã€<code data-v-8897a6ca>ProcessPayment</code></p><p data-v-8897a6ca><strong data-v-8897a6ca>é»˜è®¤æ–¹æ³•ï¼š</strong>å¦‚æœä¸å¡«å†™æ–¹æ³•ï¼Œå°†è‡ªåŠ¨ç”Ÿæˆ Createã€Getã€List ä¸‰ä¸ªåŸºç¡€æ–¹æ³•</p><p data-v-8897a6ca><strong data-v-8897a6ca>æ³¨æ„ï¼š</strong></p><ul data-v-8897a6ca><li data-v-8897a6ca>Service ç”¨äºç¼–æ’è·¨é¢†åŸŸçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¯ä»¥è°ƒç”¨å¤šä¸ª Repository</li><li data-v-8897a6ca>ç”Ÿæˆåä¼šè‡ªåŠ¨è¿è¡Œ go mod tidy ä¸‹è½½ä¾èµ–</li><li data-v-8897a6ca>å‹¾é€‰&quot;è‡ªåŠ¨æ³¨å…¥åˆ° main.go&quot;å¯è‡ªåŠ¨å®Œæˆæ¨¡å—æ³¨å†Œ</li></ul></div></details>',1)),e("div",he,[t[12]||(t[12]=e("label",null,[m(" æœåŠ¡åç§° Service Name * "),e("span",{class:"tooltip","data-tooltip":"åº”ç”¨æœåŠ¡åç§°ï¼Œç”¨äºè·¨é¢†åŸŸä¸šåŠ¡é€»è¾‘"},"â“˜")],-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.name=s),placeholder:"OrderService / PaymentService"},null,512),[[U,l.value.name]]),t[13]||(t[13]=e("span",{class:"hint"},'å¦‚æœæœªåŒ…å« "Service" åç¼€ä¼šè‡ªåŠ¨æ·»åŠ ',-1))]),C.value&&y.value?(n(),o("div",_e,[e("div",ye,[e("div",fe,i(y.value.domain_exists?"âœ…":"â„¹ï¸"),1),e("div",ge,[e("p",be,i(y.value.message),1),e("div",ke,[e("span",we,[t[14]||(t[14]=e("strong",null,"ç±»å‹:",-1)),m(" "+i(y.value.service_type==="domain_service"?"é¢†åŸŸæœåŠ¡":"è·¨é¢†åŸŸæœåŠ¡"),1)]),e("span",Ce,[t[15]||(t[15]=e("strong",null,"ç›®æ ‡:",-1)),m(" "+i(y.value.target_dir),1)]),y.value.should_reuse_dto?(n(),o("span",Se," âœ… å¤ç”¨ç°æœ‰ DTO ")):c("",!0)])]),e("button",{class:"btn-toggle-manual",onClick:t[5]||(t[5]=s=>M.value=!M.value),type:"button"},i(M.value?"ğŸ”„ è‡ªåŠ¨":"âš™ï¸ æ‰‹åŠ¨"),1)])])):c("",!0),e("div",xe,[e("div",{class:"section-header"},[t[16]||(t[16]=e("h3",null,"æ–¹æ³• Methods",-1)),e("button",{class:"btn-add",onClick:q},"+ æ·»åŠ æ–¹æ³•")]),(n(!0),o(P,null,T(l.value.methods,(s,v)=>(n(),o("div",{class:"method-row",key:v},[x(e("input",{"onUpdate:modelValue":S=>l.value.methods[v]=S,placeholder:"CreateOrder / ProcessPayment / CancelOrder",class:"method-name"},null,8,Pe),[[U,l.value.methods[v]]]),e("button",{class:"btn-remove",onClick:S=>B(v),disabled:l.value.methods.length===1},"Ã—",8,Te)]))),128)),t[17]||(t[17]=e("p",{class:"hint"},"ç•™ç©ºå°†ç”Ÿæˆé»˜è®¤æ–¹æ³•ï¼šCreateã€Getã€List",-1))]),e("div",$e,[e("div",Me,[e("label",Ve,[x(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>l.value.force=s)},null,512),[[J,l.value.force]]),t[18]||(t[18]=m(" å¼ºåˆ¶è¦†ç›– Force ",-1))]),l.value.force?(n(),o("div",Le,[...t[19]||(t[19]=[m(" âš ï¸ ",-1),e("strong",null,"è­¦å‘Šï¼š",-1),m("å¼ºåˆ¶è¦†ç›–å°†",-1),e("strong",null,"æ°¸ä¹…åˆ é™¤",-1),m("æ‰€æœ‰æ‰‹åŠ¨ä¿®æ”¹çš„ä»£ç ï¼",-1),e("br",null,null,-1),m(" åªåœ¨é¦–æ¬¡ç”Ÿæˆåç«‹å³ä¿®æ”¹æ—¶ä½¿ç”¨ã€‚ä¸€æ—¦å¼€å§‹å†™ä¸šåŠ¡é€»è¾‘ï¼Œè¯·å‹¿å‹¾é€‰æ­¤é€‰é¡¹ã€‚ ",-1)])])):c("",!0)])]),p.value?(n(),o("div",Oe,i(p.value),1)):c("",!0),e("div",Ue,[e("button",{class:"btn",onClick:E,disabled:!l.value.name||u.value},i(u.value?"åŠ è½½ä¸­...":"é¢„è§ˆ Preview"),9,De),e("button",{class:"btn primary",onClick:R,disabled:!l.value.name||u.value},i(u.value?"ç”Ÿæˆä¸­...":"ç”Ÿæˆ Generate"),9,Fe)])]),g.value&&r.value?(n(),o("div",Ge,[e("div",Ne,[e("h3",null,i(r.value.success?"âœ… å·²ç”Ÿæˆæ–‡ä»¶":"âŒ é”™è¯¯"),1),e("button",{class:"btn-close",onClick:t[7]||(t[7]=s=>g.value=!1)},"Ã—")]),e("div",qe,[(n(!0),o(P,null,T(r.value.files,s=>(n(),o("div",{class:"file",key:s.path},[e("span",{class:k(["file-status",s.status])},i(j(s.status)),3),e("span",Be,i(s.path.split("/").pop()),1)]))),128))]),r.value.message?(n(),o("div",Ee,i(r.value.message),1)):c("",!0),t[21]||(t[21]=e("div",{class:"next-steps"},[e("h4",null,"ä¸‹ä¸€æ­¥ Next Steps:"),e("ol",null,[e("li",null,"åœ¨æœåŠ¡ç»“æ„ä½“ä¸­æ³¨å…¥æ‰€éœ€çš„ Repository"),e("li",null,"åœ¨æ¯ä¸ªæ–¹æ³•ä¸­å®ç°ä¸šåŠ¡é€»è¾‘"),e("li",null,"åœ¨ main.go ä¸­æ³¨å†ŒæœåŠ¡")])],-1)),e("button",{class:"btn primary",onClick:D,style:{width:"100%","margin-top":"16px"}}," ç”Ÿæˆå¦ä¸€ä¸ª ")])):c("",!0)])])):c("",!0)]))}}),Ae=K(Re,[["__scopeId","data-v-8897a6ca"]]);export{Ae as default};
